---
title: 报告编写的艺术-3 报告内容  
date: 2024-05-09 01:10:55
tags: 报告编写的艺术  
---
  
# 0-章节（报告内容）介绍

在本章中，我们将研究渗透测试报告的各个方面。我们将涵盖数据和主要报告部分应该存在的基础知识，以及它们的内容应该涵盖的内容。我们还将讨论一些您可能在报告中遇到的附加部分（或者您可能在自己的组织中使用的部分）。

##  示例组织

为了用示例说明本章内容，我创建了一个虚构的 SaaS（软件即服务）平台 - OGPatientBooking。我们假装对整个平台进行了安全评估，并为客户制作了一份报告。

这是我们在与客户启动期间和评估期间了解到的有关应用程序的一些关键信息：

- OGPatientBooking 是一种患者预约解决方案，被英国多家医院使用
- 主要用例是患者在医院入口使用“自助”终端告知相关部门他们已到达
- 应用程序中还有一些可选模块，可以启用：
  - "医院导航" - 引导患者穿过医院
  - "患者通讯" - 允许患者查看检测结果并阅读来自医生和其他医院工作人员/部门的消息
  - "患者更新" - 允许患者更新他们的个人数据：
    - 地址，电子邮件和电话号码
    -  医生诊所
- 该解决方案是一个基于浏览器的应用程序，预计在受限制的终端界面上运行 - 尽管 OGPatientBooking 不负责确保这些终端被锁定。
- 该应用程序主要使用 Java Spring 编写，具有 JavaScript React 前端。
- 该解决方案在单个大型 EC2 实例上运行，但利用了几个 AWS 服务：
- 使用 Amazon Managed Redis 存储会话缓存
  - 使用 MySQL 服务器（使用 AWS RDS）存储所有预订数据
  - 使用 Amazon S3 存储桶托管应用程序 React 部分的前端文件
  - 亚马逊KMS用于存储医院EMR系统的凭据
- 解决方案的生产部署对所有客户来说都在 AWS 区域 eu-west-1 运行
- 所有医院客户都在一个AWS账户内运行，并共享一个数据库（系统的客户通过各种表中的client_id字段进行分隔）
- 平台有几种出站通信：
  - 与短信提供商集成，用于客户通知
  - 与电子邮件提供商集成，用于客户通知和警报
  - 与 EMR（电子医疗记录）解决方案集成，以获取有关患者的信息
- 该解决方案确实在应用程序中内置了一个管理用户级别，用于管理 OGPatientBooking 客户（即医院）

为了更清楚地说明上述内容（并作为评估的一部分），我使用 draw.io 创建了一个威胁模型图，并使用了来自 https://github.com/michenriksen/drawio-threatmodeling 的 DFD（数据流图）库

![img](https://raw.githubusercontent.com/B1ueD0g/Picture/main/202404160918335.png)

# 1-章节（报告内容）介绍 - 练习

在章节介绍中，我使用了许多术语和 AWS 服务提供的名称来描述 OGPatientBooking 平台。以下是我建议您完成的一些练习，以填补您知识中的任何空白，并帮助您理解我们将在后续课程和章节中报告的内容。

 **一般练习**

复习上一课，并记录下您不熟悉的任何术语、技术、服务或编码框架。

- 研究它们的用途或功能
- 研究如何执行安全评估（请注意，本课程中不要求您执行评估）
- 有哪些安全配置错误或其他常见漏洞会影响它们

# 2-概述

我已经提到过这一点，但值得明确说明的是 - 所有制作渗透测试报告的组织都以自己的格式和风格进行。我见过各种各样的报告变体（其中一些我将在本章的相关课程中提到），但从根本上讲，它们都试图传达类似甚至相同的信息。因此，几乎每份报告中都有一系列常见部分的清单：

- 执行摘要或结论 - 对评估的高层摘要，通常供非技术人员阅读
- 建议 - 客户应遵循的高层建议，以确保所审查的内容或建议进一步增强或评估
- 范围 - 对所评估内容的详细说明
- 注意事项 - 可能影响评估覆盖范围的任何原因
- 发现 - 评估中发现的具体漏洞详情
- 附录 - 用于存储可能太大以至于无法清晰地存储在文档的其余部分中的任何支持数据，或包含与评估相关的单独文档

上述提到的部分可能并非所有报告中都存在（也许它们的名称不同或与其他部分合并）。但是，如果您被要求创建自己的报告格式，那么您的报告很可能包含这些部分中的大部分。我们将在接下来的课程中介绍每个部分应包含的内容。

在评估风格定制且客户对评估有非常具体要求的情况下，传统的报告格式可能会被几乎完全放弃。在这些情况下，报告可能会被替换为更容易报告客户需求的内容。一个很好的例子可能是，评估的范围仅集中在测试几个特定场景，客户要求将这些信息的结果以一种他们可以在内部使用的方式显示和报告（例如，移入一个单独的系统或作为他们使用的标准流程的一部分提供给第三方开发人员）。

在这里要提到一件事，因为这似乎是最好的地方 - 几乎所有的报告都是以PDF文件的形式交付的。然而，我通常在我的工作中使用.docx文件，因为我们的报告需要经过法律审查和潜在的删除操作，然后才能交给客户，但我也看到过.docx文件在这种情况之外被使用的情况（尤其是在内部渗透测试报告中）。结果被整理成幻灯片，甚至只能在由执行评估工作的供应商开发的定制Web门户中获得，这也并不罕见。虽然存在这些可交付成果（以及其他一些），但出于本课程的目的，我们将坚持使用“传统”的报告格式。

##  课程总结

在这个简单的课程中，我们已经讨论了报告中可能出现的典型部分，并突出了几种不同形式的可交付成果。虽然本课程介绍了传统的报告格式，但大多数原则和建议适用于大多数可交付成果类型，并可以纳入其中。


# 3-概述 - 练习

在上一课中，我们讨论了出现在渗透测试报告中的常见部分。以下是一些与此相关的练习。

 **反思练习**

- 反思您可能已经阅读或撰写的任何报告（包括渗透测试或其他报告）。这些报告的结构如何与提到的常见部分相符？有哪些部分特别有用或您觉得缺失了哪些部分？是否有任何部分被赋予不同的名称？
- 想想你过去创建或看到的报告。它们使用了什么文件格式，或者结果是以什么其他方式呈现的？你觉得这些格式有效或合理吗？请解释。

# 4-杂项数据及部分

在涵盖更大、更常见的报告部分之前，我想先讨论一些可能出现在报告中的较小数据点和部分。

##  标题页

大多数报告不会立即进入讨论，它们通常有一个封面页面，其中包含：

- 评估的名称（通常来自工作说明或提案）
- 评估的日期，例如评估完成的月份和年份
- 作者的姓名或姓名
- 报告准备给个人或公司的名称

有时组织喜欢在此页面上放置他们的标志或花哨的库存图像。组织目前持有的认证有时以标志形式放置在此页面上。报告的此页面上也可能有一些免责声明，尽管也可能存在于其他地方。

##  目录

您需要让您的客户能够轻松浏览报告的各个部分。当标题与目录一起在常见文件格式中使用时，您可以轻松地在目录中单击一个部分名称，然后跳转到正确的页面。

令人惊讶的是，我曾看到一些没有目录的报告，这可能会惹恼一些客户。

目录中的页码未及时更新并不罕见（因为我自己也犯过这种错误，也在实际情况中看到过）。请记得在向客户发布任何文档之前更新此目录，如果您使用需要更新的编辑器（例如 Microsoft Word）。此外，请更新任何内部交叉引用，因为这可能会很容易中断或更改。

同样，每页应该有页码，以便于参考和帮助报告导航。更重要的是，各节应该有节号，而不仅仅是命名的节，这样阅读报告的人可以说类似“跳转到 2.2 节”。

##  变更控制

本节涵盖了文档的版本控制以及已经进行了哪些更改以及由谁进行的更改。通常出现在报告的开头附近，尽管其确切位置在评估供应商之间可能有所不同。肯定有一些报告没有这个部分，可能是因为组织不符合ISO 27001标准（也许？）。然而，出于几个原因，拥有这个部分是很好的：

- 显示您拥有文件审查和批准流程
- 跟踪谁审查了文件，何时以及为什么

 这可能看起来像：

| **Version** | **Date**   | **Author**    | **变更摘要**               |
| ----------- | ---------- | ------------- | -------------------------- |
| 0.1         | 2024-01-14 | 卢克·罗杰森   | 内部草稿，用于质量保证流程 |
| 0.2         | 2024-01-15 | 丹尼尔·詹宁斯 | 内部同行评审               |
| 1.0         | 2024-01-16 | 卢克·罗杰森   | 发布给客户                 |

这是每个标题用于的内容。

###  版本

该版本跟踪报告的（通常是）数字版本。

较小的内部或草稿更改适合 0.1 增量。当报告达到主要版本并准备与客户共享时，应将其增加到下一个整数。例如，在上表中，一旦由'Luke Rogerson'在版本 0.2 中审查或接受了任何建议的更改，将与客户共享的最终报告将更新为 1.0。

记住这一点的简单方法可能是：

- 所有关于 x.0 版本的报告都是面向客户的
- 所有关于不以 0 结尾的子版本的报告应被视为内部草稿

如果交付的报告需要更改，则在传递给客户之前也应进行审查:

| **Version** | **Date**    | **Author**       | **变更摘要**               |
| ----------- | ----------- | ---------------- | -------------------------- |
| 0.1         | 2024-01-14  | Luke Rogerson    | 内部草稿，用于质量保证流程 |
| 0.2         | 2024-01-15  | 丹尼尔·詹宁斯    | 内部同行评审               |
| 1.0         | 2024-01-15  | 卢克·罗杰森      | 发布给客户                 |
| 1.1         | 2024-01-18  | 卢克·罗杰森      | 添加了一些小的澄清         |
| 1.2         | 2024-01- 19 | Samantha Collins | 内部同行评审               |
| 2.0         | 2024-01- 20 | 卢克·罗杰森      | 发布给客户                 |

这个版本控制系统是我最常用的，然而，在制作报告时，您可能已经看到或使用了略有不同的系统。对于像这样的任何事情，最重要的是您在所有报告中保持版本一致，以免让自己困惑，也不要让您的客户困惑。

###  日期

这只是文档指定版本在可供他人进一步工作之前保存的日期，或与客户共享的日期。报告文档中使用的日期格式似乎有所不同，但我更喜欢使用 ISO 标准日期格式。如上所示，该格式为 YYYY-MM-DD 格式，其中年份表示为 4 位数字，月份表示为 2 位数字，日期表示为 2 位数字。此日期格式的示例可以是 2002-01-05 或 2024-12-21。

以这种方式显示日期有一些优点：

- 日期的结构清晰，消除了处理日期格式时可能出现的模糊性（英国日期和美国日期之间的差异 - 分别为DD/MM/YYYY和MM/DD/YYYY）
- 这种日期格式也可以更容易地在表格中进行排序，使用允许表格操作的工具（例如 Microsoft Word 或 Excel）。
  - 它还可以作为文件名前缀，以数字方式进行排序

###  作者

本节标识了所做更改的作者或作者，详细说明在更改摘要中。如果文档在版本之间由多人更改，则可以列出多个人。最好以特定方式列出作者，可以按字母顺序或按最大贡献者优先。

###  变更摘要

一些文档的变更摘要可能相当重要。然而，根据我的经验，渗透测试报告中的变更摘要通常非常具体和简洁（可以清晰地放入表格中的单元格中）。如果您想详细说明报告中更具体的变更，以显示发生了哪些特定部分的变更，请确保文档控制部分有足够的空间来清晰地展示信息（例如，您可能希望将此部分横向排列）。

##  评估团队

本部分用于列出参与评估的具体个人。它通常位于报告的附录部分，尽管报告的范围部分通常也可以看到其版本。它可能看起来像这样（或至少包含相同或类似数量的信息）：

| **Name**    | **Title** | **认证/注释**                                    |
| ----------- | --------- | ------------------------------------------------ |
| 卢克·罗杰森 | Director  | Offensive Security Certified Professional (OSCP) |

由一两个人撰写的许多报告可能并不真正需要这一部分。相反，他们可以在封面上被提及为作者，或者如前所述，在文档的范围部分。然而，保持一致很重要，所以如果您的模板使用此部分，也许最好不要删除它。

## 文档控制元数据

报告文档中包含一些额外的报告元数据并不罕见。一些文档会包含一个“文档控制”部分，其中包括这些内容（还包括“版本控制”部分）。这一部分通常位于报告的开头附近。

这一部分可能包含以下信息：

- 评估名称 - 评估的名称，可能与报告的标题相同
- 工作说明书/提案参考 - 将报告与特定的工作说明书或提案联系起来，该文档的唯一ID或名称将在此引用
- 账户经理 - 负责管理与特定客户的关系的人员
- 客户代表 - 我们与之合作进行评估的客户的主要联系人
- 参与经理 - 测试团队的团队负责人，也是我们客户的主要联系人
- 分类 - 分配给报告的分类（通常放在报告文档的页眉或页脚）。示例可能包括：
  - 客户机密 - 只有供应商和客户应查看报告
  - 公开 - 如果报告面向公众
  - 内部 - 如果报告只应在内部披露（例如内部渗透测试报告）
  - 注意：如果报告是为政府实体完成的，则可能会使用政府分类。一些客户可能坚持使用自己的分类。
- 评估日期 - 评估的开始和结束日期

### 分发列表和保密通知

常见的做法是列出谁将访问报告的名字。渗透测试报告通常包含关键或敏感信息，因此确切知道谁应该查看报告是一个好的做法（尽管一旦报告发送给客户，限制文档访问权限将由他们决定）。

这一部分可能看起来像这样：

| **Organisation** | **Name**        | **Job Title** |
| ---------------- | --------------- | ------------- |
| ogSec            | 卢克·罗杰森     | Director      |
| ogSec            | 丹尼尔·詹宁斯   | 高级研究员    |
| ogSec            | 乔治·哈里森     | 客户经理      |
| OGPatientBooking | 安德鲁·史蒂文斯 | Product Lead  |

其他报告可能只是简单地说明谁准备了报告，以及为谁准备了报告的人员名单。

还可能有一份书面声明，说明该报告只被授权与这些明确列出的个人或组织分享。

###  保修通知

与保密通知类似，可能会出现另一种法律通知来覆盖评估供应商。这可能包括以下内容：

- 报告是对所评估的安全风险的时间点快照 - 如果所评估的内容被更新和更改，报告的适用性或准确性将随时间变化。
- 评估可能未揭示每个漏洞
- 渗透测试供应商对客户或第三方因评估或其结果而造成的任何损害、损失或费用不负责
- 客户有责任确保报告中提出的漏洞得到纠正，并且在未来保持良好的安全姿态

请注意，以上内容均不构成法律建议，仅仅是对这类部分常见措辞的总结。

##  文件名

所有组织都有自己的文件命名约定；然而一个关键元素是尽量使它们尽可能独特，同时使它们易于识别。文件名结构可能由以下内容组成：

- 评估供应商名称（可能是缩写名称）
- 客户名称（可能是缩写名称）
-  评估名称
- 工作说明书或提案参考
-  日期
-  报告版本

这可能会给您一个（可怕的）文件名，看起来像“ogSec_OGPatientBooking_2002_Platform-Review-Report_2024-01-19_v2.0.pdf”。请注意，下划线用于分隔文件名的主要部分，破折号用于分隔这些子部分的部分。

一些组织更喜欢更清晰易读的命名约定："ogSec - OGPatientBooking - 2002 平台审查 - 2024-01-19 v2.0.pdf"。

##  文件元数据

你可能还需要考虑的是删除（或更好地预防）可能出现在你创建的报告中的任何敏感元数据。在这里明确一下，我指的是文件级元数据。可能出现在其中的内容有：

- 您或您的组织用于制作文档的软件的名称和版本
- 您文档的作者姓名（如果您在报告中指出文档的作者，则无关紧要）
  - 电子邮件地址和电话号码也可能存在

这可能对试图针对您组织内个人的攻击者有用。在审查客户网站上公开可用的文件时，有时会将此作为安全问题提出，因此这可能也是您需要考虑的问题。

##  课程总结

在本课程中，我们涵盖了报告中出现的一些较小部分或元数据，以及它们通常包含的内容。虽然报告材料的大部分内容将包含在其他部分中，但这些较小的部分出于各自的原因仍然很重要，并且应该出现在所有报告中。

# 5-杂项数据及部分 - 练习

这节课之后没有太多可以深究的地方，但是可能有一些反思的要点需要考虑。以下是一些练习。

 **反思练习**

- 想想你使用过或看到别人使用的报告格式。报告中是否包含了之前提到的所有部分？如果没有，你认为它们是否应该被要求，并解释原因。
- 想想你遇到过的报告文件名称，无论是内部的还是外部的。回顾它们并评论一下它们的简洁性和信息量。它们是否缺少任何关键信息？

 **一般练习**

考虑前一课程中描述的部分和页面，并为这些部分创建模板。它们应该易于调整和可重用于不同的报告中。

**超越练习**

- 查看您可以从报告交付件中提取的元数据。您可以针对以下任何文件类型进行操作：
  -  PDF 文件
  - 任何 Microsoft Office（或 Open Office）文档
  -  图像或图表
- 这里有一些工具可以帮助您入门：
  - exiftool
  - pdfinfo

# 6-执行摘要

执行摘要是每份渗透测试报告中至关重要的部分。这一部分的目标不是阐明在技术层面上发现了什么具体问题（这留给报告中的各个发现），而是为决策者和利益相关者回答以下问题：

- 在承揽范围内考虑了哪些风险和威胁？
- 发现了哪些风险？
- 发现的影响是什么？

一些执行摘要可能涵盖战略建议或应尽快实施的建议。

本节的受众通常是高管（因此得名），他们可能没有与阅读发现的人具有相同的技术经验，但通常更有可能监督已经测试过的决策制定。这些通常是决定投入什么时间、资源和金钱来进行补救的人，或者是需要离开并要求额外预算的人。

报告的这一部分出现在开头，有些情况下是文档的第一页或第二页。这样做是为了让那些想要快速了解文档内容，但没有时间或愿望完整阅读的读者，能够快速了解主要要点，并理解发现的风险可能带来的影响。我见过一些报告将这一部分放在最后。从讲故事的角度来看，这在逻辑上是有道理的，但与行业规范相比，这是不寻常且不理想的。

## 示例执行摘要

我为 OGPatientBooking 平台的评估撰写了一份执行摘要。执行摘要分为不同的部分，旨在回答我上面概述的问题。

### 设定背景 - 是什么？背景规模

由于我的背景是为收购方创建报告，因此对我来说，适当地设定背景至关重要。虽然报告文件将包含有关评估平台是什么、其规模和所持有数据的信息，但在开始时简要提及可以赋予任何后来在摘要中提出的风险或观察以庄严和背景。这实际上是所有高管摘要的绝佳引言，并我鼓励您在报告中使用这样的开场白。

这可能是什么样子的：

> OGPatientBooking解决方案是一种SaaS（软件即服务）平台，目前在英国的十几家大型医院中使用。其主要目的是为患者提供一个单一的地方，在医院自助办理入住手续，从而降低接待人员的需求或为其他任务腾出时间。该平台每天通过放置在医院入口处的终端设备为约25,000名独立患者预约（每月约75万人次）。大多数使用该平台的医院还使用“患者通讯”模块，允许患者查看检测结果或医生的消息。由于在英国大型医院的使用以及访问患者数据的能力，该解决方案潜在地可以访问约1000万人的数据。

如上所示，以下问题已被回答以铺设基础：

- 应用程序实现了什么功能？
- 解决方案在世界的哪些地区运作？
- 应用程序的主要用户是谁？（在这种情况下，医院为解决方案付费，主要用户是患者）
- 有哪些大致的数字或指标可以总结平台的使用情况？

在后续的摘要部分中，当谈论风险、可利用性、影响以及最坏情况时，这些观点中的一些将得到反映。

虽然你可以将这段文字视为可选内容，但我意识到以这种格式进行介绍有助于过渡到后面的执行摘要部分，我们将在下面看到。

###  概念风险

下一个需要关注的领域突出了影响平台的关键概念风险。这些概念风险代表着高层次的潜在威胁，虽然尚未实现，但对组织构成重大关注，必须积极防范。这些是理论上的漏洞或威胁，可能对平台的安全姿态和运营完整性产生严重影响，特别是在数据的保密性、可用性和完整性至关重要的环境中。

这些风险要么是在评估过程中发现的，要么是在与客户进行的那些启动电话中注意到的。在我阅读的许多高管摘要中，这种叙述并不总是那么常见。然而，突出向客户强调已经了解了被审查内容的潜在风险是至关重要的，同时为您提供一段文本，以便在高管摘要的下一个领域进行反思。

一个关于概念风险的示例部分可能如下所示：

> 由于平台在医院运营中的关键作用，平台的可用性和完整性以及涉及的患者数据的保密性至关重要。如果这个基本系统变得不可用，医院可能会受到严重影响。更为重要的是，从这个解决方案使用和访问的数据必须以任何代价都得到保护，因为它包含个人健康信息（PHI）。对于隐私而言，任何对这些数据的妥协或修改都可能具有重大意义，最坏的情况下可能导致生命丧失（例如，攻击者获得对医院 EMR 解决方案的访问权并更改了患者的药物或剂量）。

在这一段中提到了解决方案的两个主要资产：解决方案的可用性和它处理和存储的数据。解决方案下线或患者数据被访问或修改的后果可能对医院及其患者造成严重后果，因此将这一点突出显示是至关重要的。

在这一部分和下一部分之间需要一些流畅的过渡。此外，如果发现了重要发现，可能会诱人在本段落中详细介绍这些内容 - 避免这样做。目标只是简单地指出客户在风险方面最关心的内容（希望确实如此）。

### 发现的风险及其影响

现在是时候谈谈发现了什么了。以下是在评估过程中发现的最重要的发现列表：

**Web 应用程序评估**

- 不安全的直接对象引用
- 租户实施不足
- SQL注入患者详细信息更新界面
-  无 MFA 的管理员登录
- 管理员门户公开访问
- 医院门户在未经身份验证的情况下公开访问
- 未经身份验证的 API 端点返回医院配置
-  通用管理员帐户
- 在管理员门户中进行用户枚举
- 管理员帐户的默认密码
- EMR 存储凭据可能被捕获

 **AWS 配置审查**

- 管理员帐户未强制执行 MFA
-  包括 root 用户
- 未强制执行密码复杂性
-  未启用 CloudWatch
-  SSH 服务器暴露
- 用于生产的单个 EC2 实例
- 没有 Web 应用防火墙
- 没有配置数据库备份

这些漏洞中的一些可以被链接在一起产生戏剧效果，从而将整个平台、用户和数据置于重大风险之中。

如果您对这些漏洞或配置错误中的任何一个都感到陌生，请花些时间查找并做笔记。这样，我接下来要描述的内容会更加容易理解。

这是执行摘要的下一部分，也是最重要的部分：

> 虽然该应用程序展示了一些安全的网络应用程序安全实践领域，以及在外部面向网络应用程序部署方面的几个安全配置，但一些具体的发现和架构上的问题意味着患者数据面临着被泄露的重大风险。
>
> 由于登记流程的方式，到达医院的患者需要通过触摸屏验证身份，并按照多步骤的流程使用出生日期进行验证。尝试使用触摸屏猜测出生日期是可能的，但对攻击者来说并不可行。然而，在测试过程中发现，所有医院的登记页面都可以通过互联网访问，并且很容易被发现。这意味着可以创建自动化工具，请求所有出生日期（过去100年）以返回当天有预约的患者名单。一旦攻击者处于这种位置，他们可以使用从患者预约中返回的详细信息来访问检查结果、医生的消息或查看或更新他们的个人信息（电子邮件地址、电话号码和医生诊所）。发现医院的门户页面只需要猜测一个URL，这对攻击者来说是很容易的。随后对登记流程的利用也将非常容易，因为有可用的工具可以帮助进行此类攻击。
>
> 一旦攻击者处于上述位置，他们将能够利用平台中的其他漏洞，从而获取托管在平台上的所有医院的所有预约数据的访问权限。由于在用于存储所有医院数据的单个数据库中，不同医院数据之间的隔离非常有限，因此可以读取、修改或删除这些记录。攻击者不仅可以从所有这些患者那里提取个人信息，还可以通过删除所有记录有效地取消所有预约。假设攻击者成功获得了一个患者的预约访问权限，这些漏洞对于经验丰富的攻击者来说将很容易发现。
>
> 与医院的登记页面一样，每家医院的管理面板也是可以访问的。一旦发现了医院的登记页面位置，攻击者就很容易发现管理页面。更糟糕的是，使用的是通用管理帐户，并且对于几家医院来说，它还没有从默认值（在公开可访问的文档中可用）中更改。使用这个帐户访问这个区域将允许攻击者更改许多设置，这可能导致使某家医院的系统下线。
>
> 平台的前端不仅面临着重大风险，解决方案的部署以及在 AWS 中缺乏加固措施意味着攻击者可能能够访问 AWS。如果攻击者能够猜测或获取 AWS 管理员的用户名和密码，他们将完全控制整个解决方案，并能够访问、修改或删除平台内的所有数据。如果启用了多因素身份验证，这种情况是可以避免的。
>
> 此外，攻击者还可以访问凭证材料（存储安全但所有AWS用户都可以访问）以访问医院EMR系统，显著增加攻击者可以访问的数据类型。例如，这可能是约1000万患者的病历。对这些数据的任何泄露可能违反2018年数据保护法或英国《一般数据保护条例》（GDPR），该法规涵盖个人健康信息。对这些数据的泄露可能导致OGPatientBooking受到严厉处罚。
>
> 尽管架构审查不在此评估范围内，但注意到解决方案在 AWS 中没有足够的高可用性配置，也没有有效的备份。如果发生违规行为，并且应用程序受到拒绝服务条件的影响，这将产生重大影响。例如，正如已经提到的，如果数据库内容被删除，目前没有已知的恢复数据的方法。此外，如果运行在单个 EC2 实例上的应用程序受到拒绝服务条件的影响，将没有简单的方法来扩展负载。这两个例子表明，这个关键系统的可用性可能会很容易受到具有足够资源或访问权限的攻击者的影响。
>
> 由于代码审查不在此评估范围内，因此无法确定 Web 应用程序本身的日志记录实现，但是，AWS 环境的日志记录和监控配置处于默认状态。这意味着无法审查 AWS 环境的任何审核，其中管理员已经进行了身份验证并对环境进行了更改。
>
> 根据确定的实施和架构问题，该平台存在严重的潜在违规风险，允许攻击者访问敏感的患者数据，并使其容易受到拒绝服务的影响。由于可以轻松获取公开可访问页面的 URL，数据泄露和未经授权访问应用程序配置面板的可能性很高。攻击者利用系统所需的后续步骤很少，对应用程序安全构成严重威胁。立即采取行动，调查和纠正应用程序的入口点，并确认是否发生过任何历史患者数据泄露。

如果您是报告撰写的新手，或者也许您以前没有在类似这样的部分中看到过这个级别/类型的信息，并且感到沮丧或受到威胁 - 请不要。您应该专注于确保关键信息和分析的存在，而不需要模仿我的写作风格（或其他人的）。请记住，报告撰写是一种需要练习的技能，在这门课程和您自己的工作中都会有大量练习的机会。

现在，让我们回顾一下这段文字，并逐步构建这一部分草稿的方法。

摘要的这一部分分为三个方面：

- 为安全影响和高层次后果设定场景
- 每个重要段落：
  -  攻击链
  - 漏洞或配置错误
  -  系统问题
  -  极端的做法
- （可选）日志记录和监控功能
-  结尾声明

我发现解决这些部分的最佳方法是回答几个问题，然后对文本进行细化，使其流畅。让我们看看这是什么样子。

###  设置场景

从对正在评估的安全风险景观的观点开始

- 我们对安全风险的高层次观点是什么？有多糟糕或多好？
- 哪些资产（用户、数据、系统等）受到的影响最为显著？
- 有什么好东西可以反映或评论吗？
  - 提及好东西是可以的，但不要让好东西掩盖了不好的地方，如果有重要发现，请改变本节的必要语气。

### 运行风险

这部分通常会是报告中需要提及的重要事项的段落。有多种方法可以处理这个问题，所以我将概述几组类似的问题。请注意，您可能需要在单个执行摘要中使用多个相同类型的部分或以下变体。请记住，这部分的构建方式没有严格的规定，我们只需要确保所需信息以一种易于理解的方式呈现。

在下面我提到的内容之外可能还有其他类别，但这应该足以为您提供一些方向，以应对这一部分。一旦您回答了这些问题，文本应该被审查和完善，使其流畅并且有意义。如果这意味着您需要偏离“每段一个主题”的模式，或者需要改变结构的其他方面 - 那完全没问题。

记住 - 尽量避免在本节中包含技术细节。

攻击链 - 通过利用多个漏洞可能危害资产。

- 攻击链的起点是什么，是否需要简要解释某些工作原理？
- 在涉及的每个步骤中，攻击者要做什么才能继续下一步？
- 一旦资产被危害，影响是什么？
  - 攻击者现在可以访问什么？
  - 他们可以利用这个访问权限做什么？
  - 他们可以对他们访问的东西做什么？
  - 现在他们能够攻击其他东西吗，他们是什么？
  - 现在可能发生的最糟糕的情况是什么？
- 攻击者有多容易利用这种攻击链，攻击者可能会发现它的可能性有多大？
- 在这个攻击链中是否有任何显著的缓解措施，可以防止攻击链中的漏洞被发现或利用？

单一重大漏洞或配置错误 - 通过利用单一漏洞或配置错误，可以利用资产

- 问题的性质和攻击者的利用路径的高级概述是什么？
- 一旦资产被危害，影响是什么？
  - 攻击者现在可以访问什么？
  - 他们可以利用这个访问权限做什么？
  - 他们可以对他们访问到的东西做什么？
  - 现在他们能够攻击其他事物吗，他们是什么？
  - 现在可能发生的最糟糕的情况是什么？
- 攻击者有多容易利用这个漏洞或错误配置，攻击者发现它的可能性有多大？
- 在这个攻击链中是否有任何显著的缓解措施，可以防止发现或利用漏洞或错误配置？

系统性问题或不良实践 - 发现了一个严重问题，它存在于整个解决方案中

- 在评估过程中观察到了什么类型的问题或不良实践？
  - 避免提及漏洞的技术信息，最好只涉及其类型以及攻击者可能利用它做什么
  - 这也可能是由于没有遵循良好的实践
- 漏洞在整个解决方案中有多常见？它是否可以很容易地得到纠正（无论是否已知）
- 一旦资产被危害，影响是什么？
  - 攻击者现在可以访问什么？
  - 他们可以利用这个访问权限做什么？
  - 他们可以对他们访问到的东西做什么？
  - 现在他们能够攻击其他事物吗，他们是什么？
  - 现在可能发生的最糟糕的情况是什么？
- 攻击者有多容易利用这个普遍问题或不良实践，攻击者可能会发现它的可能性有多大？
- 在这个攻击链中是否有任何显著的缓解措施，可以防止链中的漏洞被发现或利用？

### 日志记录和监控功能的洞察

如果发现了关键发现，您认为有很高的可能性已被利用（或目前正在被利用），那么如果您对日志记录和监控有任何洞察力，评论可能是有意义的。这可能会使下一课中我们将涵盖的建议部分更容易反思。

 要回答的问题：

- 您观察到了哪些可能检测到解决方案中恶意活动的日志记录和监控？如果您没有看到任何内容（可能是因为它不在范围内或根本没有），请说明
- 根据第一个问题的答案 - 这对客户可能会产生什么后果？
  - 如果他们有日志记录，可以建议他们可能有数据可供调查
  - 如果没有日志记录，建议可能难以检测到违规行为
  - 如果您对日志记录功能没有了解，应该直接说明

###  结束声明

撰写一份陈述，通过将您讨论的内容压缩成一个段落来总结摘要

 需要回答的问题：

- 影响审查的整体安全风险是什么？
- 在最坏的情况下，哪些资产受到影响，以及受到了什么程度的影响？
- 为客户建议哪些高层次的即时行动？

保持这段文字简洁明了。

## 关于可利用性和影响的说明

对于更大的执行摘要，其中有许多主题需要总结，措辞可能开始变得重复。这通常发生在有多个妥协资产的途径或者在评估中存在许多漏洞类别的情况下。如果在审查文本时注意到这一点，请考虑将有关可利用性和影响的部分中的一些或全部注释移至结束语句中 - 在上面的示例中已经做到了一定程度。

## 有限发现方法

如果评估产生了有限的重大发现，或者根本没有重大发现，执行摘要的这一部分应侧重于找到的关键漏洞（如果有的话），并在必要时描述影响、可利用性和可能性（如上述部分所述）。

如果报告大部分是好的，您可以尝试描述良好安全姿态证据已经到位的情况：

- 您观察到哪些证据表明良好的安全实践得到了遵循？
  - 这可能包括在各种漏洞类别中没有发现，尽管经过严格测试。
  - 这也可能是安全功能和加固的存在

##  建议？

我将在下一课中涵盖这些内容。但值得指出的是，通常情况下，要么在本节之后列出明确的下一步清单，要么提出一些战略性建议。建议要么完全融入本节，要么单独列出。我们将在即将到来的建议课程中涵盖这一点。

##  完整示例

这里是所有示例汇总为一段文本。这是一个相当长的执行摘要，大约有两页的字数，通常一页左右就足够了。

> OGPatientBooking 解决方案是一个在英国超过十几家大型医院中使用的 SaaS（软件即服务）平台。其主要目的是作为患者在医院自助登记的单一地点，随后降低了接待人员的需求或为其他任务腾出时间。该平台每天通过放置在医院入口处的终端为大约 25,000 名独特患者预约（每月约 750,000 人）。大多数使用该平台的医院还使用“患者通信”模块，允许患者查看检查结果或医生的消息。由于在英国大型医院的使用以及访问患者数据的能力，该解决方案潜在地可以访问约 1000 万人的数据。
>
> 由于平台在医院运营中的关键作用，平台的可用性和完整性以及涉及的患者数据的保密性至关重要。如果这个基本系统变得不可用，医院可能会受到严重影响。更为关键的是，从这个解决方案使用和访问的数据必须以任何代价都得到保护，因为其中包含个人健康信息（PHI）。对这些数据的任何妥协或修改可能在隐私方面具有重大意义，在最坏的情况下（例如，攻击者获取了对医院EMR解决方案的访问权限并更改了患者的药物或剂量），可能导致生命丧失。
>
> 尽管该应用展示了一些安全的网络应用程序安全实践领域，以及在外部面向的网络应用程序部署方面的几个安全配置，但一些具体的发现和架构上的担忧意味着患者数据面临着重大的危险。
>
> 由于登记流程的方式，到达医院的患者需要通过触摸屏验证身份，并按照多步骤的流程使用出生日期进行验证。尝试通过触摸屏猜测出生日期是可能的，但对攻击者来说不可行。然而，在测试中发现，所有医院的登记页面都可以通过互联网访问，并且很容易被发现。这意味着可以创建自动化工具，请求所有出生日期（过去100年）以返回当天有预约的患者列表。一旦攻击者处于这种位置，他们可以使用从患者预约中返回的详细信息来访问检查结果、医生的消息，或查看或更新他们的个人信息（电子邮件地址、电话号码和医生诊所）。发现医院的门户页面只需要猜测一个URL，这对攻击者来说很容易。随后对登记流程的利用也将非常容易，因为有可用的工具可以帮助进行此类攻击。
>
> 一旦攻击者处于上述位置，他们将能够利用平台中的其他漏洞，从而获得托管在平台上的所有医院的所有预约数据的访问权限。可以访问、修改或删除这些记录，因为在用于托管平台的单个数据库中，不同医院数据之间的隔离非常有限。攻击者不仅可以从所有这些患者那里提取个人信息，还可以通过删除所有记录有效地取消所有预约。这些漏洞对经验丰富的攻击者来说很容易发现，假设他们成功获得了一个患者的预约访问权限，那么攻击发生的可能性就会增加。
>
> 就像医院的登记页面是公开可访问的一样，每家医院的管理面板也是可以访问的。一旦发现了医院的登记页面位置，攻击者就很容易发现管理页面。更糟糕的是，使用了通用的管理账户，并且对于一些医院来说，这个账户的默认值没有被更改（这个默认值在公共文档中是公开可见的）。使用这个账户访问这个区域将允许攻击者更改许多设置，可能导致某家医院的系统下线。
>
> 平台的前端不仅面临着重大风险，解决方案的部署以及在 AWS 中缺乏加固措施意味着攻击者可能能够访问 AWS。如果攻击者能够猜测或获取 AWS 管理员的用户名和密码，他们将完全控制整个解决方案，并能够访问、修改或删除平台内的所有数据。如果启用了多因素身份验证，这种情况是可以避免的。
>
> 此外，攻击者还可以访问凭证材料（存储安全但所有AWS用户都可以访问）以访问医院EMR系统，显著增加攻击者可以访问的数据类型。例如，这可能是约1000万患者的病历。对这些数据的任何泄露可能违反2018年数据保护法或英国《一般数据保护条例》（GDPR），该法规涵盖个人健康信息。对这些数据的泄露可能导致OGPatientBooking受到严厉处罚。
>
> 尽管架构审查不在此评估范围内，但注意到解决方案在 AWS 中没有足够的高可用性配置，也没有有效的备份。如果发生违规行为，并且应用程序受到拒绝服务条件的影响，这将产生重大影响。例如，正如已经提到的，如果数据库内容被删除，目前没有已知的恢复数据的方法。此外，如果运行在单个 EC2 实例上的应用程序受到拒绝服务条件的影响，将没有简单的方法来扩展负载。这两个例子表明，这个关键系统的可用性可能会受到具有足够资源或访问权限的攻击者的影响。
>
> 由于代码审查不在此评估范围内，因此无法确定 Web 应用程序本身的日志记录实现，但是 AWS 环境的日志记录和监控配置处于默认状态。这意味着无法审查 AWS 环境的任何审计，其中管理员已经进行了身份验证并对环境进行了更改。
>
> 根据确定的实施和架构问题，该平台存在潜在违规的重大风险，允许攻击者访问敏感的患者数据，并使其容易受到拒绝服务的影响。由于可以轻松获取公开可访问页面的 URL，数据泄露和未经授权访问应用程序配置面板的可能性很高。攻击者利用系统所需的后续步骤很少，对应用程序的安全性构成严重威胁。需要立即采取行动调查和纠正应用程序的入口点，并确认是否发生过任何历史患者数据泄露事件。

##  课程总结

执行摘要是渗透测试报告中最重要的部分之一。在其中，您需要清晰地阐明影响组织的风险，以及利用这些风险可能带来的影响。该部分应使报告的读者清楚地了解评估过程中发现的内容，并且应该为非技术决策者所理解。

写好执行摘要并非一蹴而就。希望本课程中概述的信息能够提高你在质量和内容方面的水平，但是持续的练习、反思和自我提升才能改善你的写作。因此，如果你觉得我在这里展示的例子对你来说难以达到，不要灰心——通过练习，你应该能够达到甚至超越我所写的水平。

# 7-执行摘要 - 练习

我们刚刚涵盖了报告中最冗长且可能最重要的部分，我们涵盖了许多内容，如果不经常练习，很容易被遗忘。

 **反思练习**

- 反思一下你可能读过或写过的任何报告。
  - 根据之前的课程，您觉得执行摘要中有什么重要的内容遗漏了吗？如果有，现在写下来。
  - 摘要中是否有引言段落或突出所审查内容的概念风险？如果没有，您现在可以写吗？

 **一般练习**

在课程结束时将有一项报告写作任务，以下是一些具体情景，帮助您练习撰写本节的内容。不必觉得您需要生成与上一个示例中相同数量的文本，但可以随意借鉴任何风格或措辞。虽然我说您不应该模仿我的写作风格，但可以用它作为灵感。

针对以下每个情况，根据以下事实撰写一份执行摘要。随时添加其他事实、问题或甚至攻击的链接以便撰写摘要（将这些视为您可以撰写的模板）。如果您添加任何内容，请做笔记。我们将在本章的其余部分继续处理这些示例。

再次，如果您对任何漏洞或错误类别感到陌生，请搜索定义并做笔记。

------



## 足球结果网站 AKA Goal Gobblers 的网络应用程序测试

 **上下文和信息**

- 跟踪英国和美国所有联赛的足球比分
- 它通过与提供评分信息的多个第三方网站进行通信来实现这一点。
- 用户可以注册接收所选团队的通知。
- 该平台平均每天接待5万名访客
- 该平台拥有大约 10,000 名注册用户
- 收入来自嵌入在页面上的广告
- 该应用有一个适用于移动设备的版本
- 应用程序的前端是 React.js，后端是 Node.js
- 解决方案部署在 AWS 中，但除此之外，不清楚配置或部署的具体情况

 **评估范围**

ScoreScraper.com 网站的 Web 应用程序评估

 **发现**

- 在个人资料更新页面中的身份验证 SQL 注入
-  身份验证绕过
- 反射型跨站脚本
-  支持 SSLv3
- 不支持多因素身份验证
- 忘记密码时的电子邮件枚举
- 过度宽松的跨域资源共享
- 即将到期的证书

 **缓解措施**

已部署网络应用防火墙 - 阻止部分攻击，但不是全部

## 电子商务网站的 Google 平台配置审查 - AKA Retail Rodeo

 **上下文和信息**

- 评估流行电子商务平台的 GCP 配置
- 该电子商务平台拥有超过 10 万名直接客户销售物品
- 整个解决方案每年为超过 2000 万客户提供销售服务
- 该平台还保存了选择不使用 PayPal 或类似支付处理器的客户的付款卡信息。
- 该平台是跨国的，运营在英国、美国、几个欧盟主要国家以及澳大利亚和新西兰。
- 电子商务平台的收入来自于每个卖家每月的固定费用，以及从每笔销售中收取的一小部分百分比。
- 该解决方案是在Django Python网络框架中开发的，并使用了PostgreSQL数据库。

 **评估范围**

对预生产环境的 GCP 配置进行审查，该环境是生产环境的复制品（将部署到全球各个地区）

 **发现**

- 公开的云存储桶
- 过于宽松的防火墙规则（RDP 和 SSH 暴露）
- App Engine 和 Google Cloud SQL 中的有限日志记录和监控
- 云存储桶在静态时未加密
- 云存储桶可通过 HTTP 访问
- 过于宽松的 IAM 角色
- 缺乏 PCI 环境的隔离
- 应用引擎使用的服务帐户权限过多
-  缺乏用户群体
- 存储在环境变量中的秘密
- PostgreSQL数据库缺乏备份
- App Engine 设置的安全标头丢失

 **缓解措施**

CloudFlare 用于 Web 应用程序防火墙和面向客户端点的拒绝服务保护

# 8-建议

建议部分（通常称为战略建议），位于个别问题之外，属于高层次，遵循（或作为执行摘要的一部分包括在内）。

传统的思考这一部分的方式是将项目放在短期、中期和长期标题下。我不喜欢这种方法，似乎许多组织也同意，因为这种格式随着时间的推移已经消失。

更常见的做法是突出客户应立即解决的紧急问题，然后是其他几个中长期类别：

- 发现任何其他重要问题
- 强调可以提出的建议，以便发现未来可能出现的问题，或者完全预防它们
- 建议可以进行的进一步工作，以发现风险

我们将在接下来的几节中详细讨论上述内容，然而，我必须再次强调，传达这些信息有许多种方式，您当前的流程或报告结构可能与我提出的不同。这没关系 - 如果您在下面的信息中包含了某种形式的建议部分，那可能是可以的。

从写作风格的角度来看，确保您专注于需要完成的事情，而不是深入探讨为什么要这样做或当前问题为什么糟糕 - 具体细节应该在报告的发现部分中涵盖（并在执行摘要中提及）。

##  立即下一步

正如前一课所提到的，如果本节是执行摘要的延续，或者是其版本，那么以简明、清晰、优先级明确的项目列表呈现信息将会很有帮助，这些项目可以被采取行动。

就 OGPatientBooking 平台而言，他们的开发团队需要处理大量工作，然而，眼下最紧要的是减少其解决方案的攻击面，并防止可避免的攻击。

以下是可能在前一课执行摘要结束后看起来如何的内容：

> 根据确定的实施和架构问题，该平台存在严重的潜在风险，允许攻击者访问敏感的患者数据，并使其容易受到拒绝服务条件的影响。数据泄露和未经授权访问应用程序配置面板的可能性很高，主要是因为轻松获取公开可访问页面的 URL。攻击者利用系统所需的后续步骤很少，对应用程序安全构成严重威胁。需要立即采取行动调查和修复应用程序的入口点，并确认是否发生过任何历史患者数据泄露。
>
> 建议采取以下即时步骤，显著减少解决方案的攻击面，并防止对基础设施的重大攻击：
>
> - 与医院合作，实施防火墙规则，将其登记门户锁定为仅可从其网络访问。
> - 对于管理面板也应执行相同操作。
> - 与医院合作，确保他们的管理密码已更改。
> - 查看 Web 应用程序和 AWS 日志，以确定是否发生了违规行为。
> - 确保在此过程中识别和纠正任何日志记录和监控方面的漏洞。
> - 对所有 AWS 用户强制执行多因素身份验证。

这也可以作为独立的部分呈现，可以采用完全相同的格式，也可以稍微深入一些。我更喜欢的方法是保持简洁，并作为执行摘要的延伸，并链接到一个单独的战略建议部分，其中包含这些条目的更深入内容，但也包含组织要遵循的更多行动项目。

> 有关战略建议的完整列表，包括上述的即时关注事项，请参阅第 x.x 节。

## 战略建议

战略建议部分的目标是向客户阐明他们可以在各个方面进行重大变革以改善整体安全性。这也应包括在执行摘要中提出的任何建议，以及指出报告中特定问题的整改措施（这将极大地改善所评估内容的安全状况），这些措施可以由某些组合集体完成，也可以根据其重要性单独完成。

这也是建议客户可能受益的其他审查的好地方（这可能会为您带来更多工作-创建一份有价值且受欢迎的报告的另一个原因是未来可能的工作）。这些审查可能是原始范围的进一步延伸，可能需要调查的新领域，甚至是如果发现或高度怀疑或可能发生违规行为时的事件响应服务（尽管我期望如果是这种情况，已经与客户进行了一些直接沟通）。

这是 OGPatientBooking 的示例战略建议部分：

> OGPatientBooking 应该审查此报告的发现和摘要，并计划根据它们带来的风险和影响来修复漏洞。
>
> 显著增加解决方案攻击面的关键漏洞应首先得到修复。任何互联网用户都能够访问医院门户登记页面和相应的管理页面的能力应该被阻止：只有来自预期通信的医院网络才能访问这些页面。
>
> 与医院合作，确保默认管理员帐户密码已更改，并鼓励为每个管理员创建特定用户帐户，而不是使用通用帐户。还应制定废弃默认帐户的计划，并在设置过程中创建命名帐户。
>
> 确保所有 AWS 用户强制执行和启用双因素身份验证，同时加强用户密码复杂性要求。应启用 AWS Config 日志记录并馈送到 CloudWatch。还应将来自资产内其他组件的日志记录馈送到 CloudWatch。为所有相关组件启用备份。
>
> 审查 Web 应用程序和 AWS 环境的所有可用日志，以确认是否发生未经授权访问数据的情况。如果不存在可以显示此类证据的日志，请确保将其作为解决本报告中问题的一部分实施。
>
> 请注意，您可以联系 ogSec 寻求有关当前或过去违规行为的确定以及有关所描述的漏洞的帮助，以及帮助识别可能存在于代码级别或 AWS 内部的日志记录和监控差距。
>
> 实施身份验证以登录到门户页面（即医院内的触摸屏在使用前需要登录到应用程序）。强制执行强密码复杂性要求，可能还需要多因素身份验证。此外，为管理员用户开发多因素身份验证，并确保在应用程序内强制执行。
>
> 考虑在解决方案的管理面板中实现一个受信任网络列表，以便管理员能够自行添加防火墙配置。
>
> 审查解决方案中的租赁模型，并可能比当前通过简单的数据库列键实现的更加分离医院之间。最好的隔离可能是将医院分隔到它们自己的 AWS 帐户中，拥有自己的数据库和其他组件。
>
> 同样，全面审查解决方案的架构，看看是否可以利用其他 AWS 服务来使解决方案能够有效扩展，并消除任何单点故障。
>
> 考虑定期扫描 AWS 环境，以发现潜在的配置错误和进一步加固的机会。
>
> 如果尚未执行，请执行静态代码分析，检查可能存在的常见实现级安全问题，并确保它们不会提交到生产代码中。
>
> 考虑寻求代码辅助的网络应用程序评估解决方案，以检查进一步的实现、业务逻辑或配置问题，这些问题可能在评估时间内无法发现。

这是构建此部分的方法论：

- 提醒客户全面审查此报告，以便根据它们对解决方案的风险来规划和纠正发现。
- 针对需要立即解决的问题进行梳理，如果您在执行摘要中简洁提到了它们，或者在它们自己的子部分中稍微深入讨论。
- 突出应执行的任何其他重要行动项目，无论是基于执行摘要中指出的内容，还是基于特定的关键问题。
- 将所有发现作为一个整体进行审查。如果您能想到某一类漏洞可以通过战略性方式来预防或发现（例如持续的云安全扫描、漏洞扫描、静态代码分析、开发加固或最佳实践指南等），请提出建议。
  - 理想情况下，您也应该在问题建议中提到这一点，这将使这个过程更容易（稍后在课程中详细介绍）。
- 如果您对应该进行进一步评估工作有建议，请陈述原因，说明为什么这对客户有益。

好消息是，您可以将这里的一些建议模板化，因为许多战略建议将适用于许多评估和大多数客户，所以在撰写这些建议并将其保存以供以后使用时要聪明。

##  课程总结

建议部分是所有渗透测试报告的关键部分。它概括了组织在评估后需要解决的重要行动项目，同时提供了进一步保护所评估内容的几个战略考虑因素。一个好的建议部分涵盖了客户可以实施的预防选项，同时建议了发现新漏洞实例的策略。

# 9-建议 - 练习

上一课程介绍了如何使用遵循 OGPatientBooking 执行摘要的示例构建报告的推荐部分。

让我们继续进行一些练习，延续之前的执行摘要练习：

 **反思练习**

- 反思您可能已经阅读或撰写的任何报告（渗透测试或其他）。
  - 你是否写了类似“下一步”部分的内容？如果没有，现在可以写一下吗？
  - 你的战略建议部分采取了什么形式？根据上一课的内容，你觉得有什么遗漏的地方吗？现在写下你认为遗漏的内容

 **一般练习**

- 对于之前的两个示例测试（Goal Gobblers 网站评估和 Retail Rodeo 的 GCP 回顾），为两者都写下战略建议部分。
  - 随意创建细节来完善您的叙述，并以我的先前示例作为您需要写的灵感。
- 为每个部分编写“下一步”部分，可以作为执行摘要的延续或独立的部分。
- 考虑您可以放入报告中的高层战略建议性陈述。为这些常见段落创建模板，以便您可以在未来的工作中使用它们。

#  10-调查结果概述

大多数报告中都有几个部分与调查结果概述有关：

- 所有结果的高级视图，可以作为基于严重性的汇总表，也可以是图形/图形，以显示基于严重性的结果分布
- 一个列表，其中包含找到的每个发现以及相应的严重性（可能还有一些其他属性）

让我们浏览下面这些部分。

## 调查结果概述

调查结果的高级别概述通常位于报告的开头附近，并且通常紧随执行摘要。就我所见，其位置各不相同，有时会缺失。

这是它可能看起来的样子：

| **评估阶段**     | **Critical** | **High** | **Medium** | **Low** | **Info** | **Total** |
| ---------------- | ------------ | -------- | ---------- | ------- | -------- | --------- |
| Web 应用程序审查 | 3            | 1        | 5          | 5       | 0        | 14        |
| AWS 配置审查     | 1            | 3        | 4          | 10      | 2        | 20        |
| Total            | 4            | 4        | 9          | 15      | 2        | 34        |

这并不特别吸引人，只是让你对数字有了一些感觉。如果你有许多阶段可以进行比较，并且数字之间的差异很大，那么它可能会提供一些显著的见解，但实际上，发现本身需要它们的上下文来展示某事有多糟糕，或者某事有多难修复。尽管如此，高管们喜欢数字，所以我们应该提供给他们。

表示这些数据的其他方式可能是通过柱状图或饼图，如果您想显示严重程度的分布，这可能会更具视觉吸引力。

这里有一些相同数据以图表形式显示的示例：

条形图（分组柱状图）

![img](https://raw.githubusercontent.com/B1ueD0g/Picture/main/202404161002790.png)

 **饼图**

![img](https://raw.githubusercontent.com/B1ueD0g/Picture/main/202404161002446.png)

我看过的另一种分类方式可能对某些客户有用，而且肯定是一种展示数据的不同方式，就是基于发现类别创建摘要表格或图表。这种方法确实需要在撰写时对所有发现进行分类（这取决于您如何进行报告，可能容易也可能困难）。这可能会为对哪些组件或领域有最多发现感兴趣的客户提供洞察（再次强调，仅仅看数字并不总是有帮助的）。

##  发现清单

通常，在发现部分之前会列出所有发现的列表，如果有的话。该部分包含所有发现的表格，标题，评估阶段，发现 ID 和风险。该表格还可以用于显示发现的当前状态（例如，是否已经被修复）。

这里是一个可能的示例：

| **评估阶段**     | **Finding ID** | **Risk** | **Status**  | **Title**                              |
| ---------------- | -------------- | -------- | ----------- | -------------------------------------- |
| Web 应用程序评估 | CSK            | Critical | Closed      | 未经身份验证的 API 端点返回医院配置    |
| Web 应用程序评估 | ZNB            | Critical | Closed      | 为管理员帐户设置默认密码               |
| Web 应用程序评估 | JXY            | Critical | Open        | 通用管理员帐户                         |
| Web 应用程序评估 | IIB            | High     | Closed      | 不安全的直接对象引用                   |
| Web 应用程序评估 | CJZ            | High     | Closed      | SQL 注入患者详细信息更新屏幕           |
| Web 应用程序评估 | XQJ            | High     | Closed      | 无 MFA 的管理员登录                    |
| Web 应用程序评估 | GLK            | High     | Closed      | 管理员门户公开访问                     |
| Web 应用程序评估 | NAA            | High     | Part Closed | 医院门户在未经身份验证的情况下公开访问 |
| Web 应用程序评估 | WOO            | Medium   | Open        | 租户实施不足                           |
| Web 应用程序评估 | SAU            | Medium   | Open        | 可能捕获 EMR 存储凭据                  |
| Web 应用程序评估 | IUF            | Medium   | Open        | 未设置速率限制                         |
| Web 应用程序评估 | LAM            | Medium   | Open        | 可猜测的管理员网址                     |
| AWS 配置审查     | TDL            | High     | Closed      | 管理员帐户未强制使用 MFA               |
| AWS 配置审查     | DWM            | High     | Closed      | 未强制密码复杂性                       |
| AWS 配置审查     | CIV            | High     | Closed      | 未启用 Cloudwatch                      |
| AWS 配置审查     | EDE            | High     | Closed      | SSH 服务器暴露                         |
| AWS 配置审查     | CTY            | High     | Open        | 单个 EC2 实例用于生产 - DoS 风险       |
| AWS 配置审查     | FBB            | High     | Open        | No Backups                             |
| AWS 配置审查     | PSY            | High     | Closed      | 未启用 MFA 删除功能的数据库            |
| AWS 配置审查     | ISN            | Medium   | Open        | 没有 Web 应用防火墙                    |
| AWS 配置审查     | DXU            | Medium   | Open        | 缺乏用户组                             |

这为客户提供了一个按评估阶段和严重程度排序的列表，可以快速查看已发现的问题。请注意，您的标识符可能与此不同（假设您使用它们），也许您可以在这里省略阶段名称或发现状态。再次强调，此表格可以根据您的喜好进行定制，但请确保列表包含带有其相应严重程度的发现名称。

##  课程总结

为客户提供已发现内容的高级计数可能会吸引高管，我们通常很容易提供这些信息。因此，报告应努力提供这种简单的概述。此外，一个列举所有发现及其严重级别的部分对于客户（可能是更技术性的读者）来说非常有用，可以让他们对已发现的内容有一个非常高层次的了解。同样，这是另一个应该很容易组织并包含在报告中的琐碎部分。

# 11-调查结果概述 - 练习

在上一课中，我们介绍了用于显示结果列表的两个常见部分。 这里有一些相关的练习。

## 反思练习

反思您读过或写过的报告。 是否有调查结果概述或调查结果列表部分？ 如果有，信息是如何呈现的？ 您能否根据上一课改进所提供的内容，或者如果缺少其中一个或两个部分，现在可以创建它吗？

## 一般练习

让我们再次查看 Goal Gobbler 和 Retail Rodeo 应用程序的调查结果来创建这些部分。

以下是有关问题的提醒：

<u>Goal Gobbler Findings</u>：

- 配置文件更新页面中经过身份验证的 SQL 注入
- 身份验证绕过
- 反射式跨站脚本
- 支持 SSLv3
- 不支持多重身份验证
- 忘记密码时的电子邮件枚举
- 过于宽松的跨域源资源共享
- 证书即将到期

<u>Retail Rodeo Findings</u>：

- 暴露的云存储桶
- 过于宽松的防火墙规则（暴露 RDP 和 SSH）
- App Engine 和 Google Cloud SQL 中的有限日志记录和监控
- 云存储桶静态时未加密
- 可通过 HTTP 访问的云存储桶
- 过于宽松的 IAM 角色
- PCI 环境缺乏隔离
- App Engine 使用的服务帐户权限过多
- 缺乏用户群体
- 存储在环境变量中的秘密
- PostgreSQL 数据库缺乏备份
- 缺少 App Engine 设置的安全标头

<u>Exercises</u>

- 对于列出的每个漏洞，为其分配风险分类。 由于我们没有讨论严重性，所以请随意采取简单的方法并根据您自己的经验猜测它们可能是什么。
  - 或者，如果您感到有动力，请回顾调查结果，将其潜在风险置于背景中（在执行摘要课程中提供），并像您在日常工作中可能的那样对它们进行评级（如果适用）
- 使用您对每个组织得出的评级：
  - 创建基于严重性的汇总表
  - 创建条形图来显示数据
  - 创建饼图来显示数据
  - 研究可以显示数据的其他方法并尝试这些方法
  - 创建问题列表，列出问题的严重性以及您认为可能有用的其他元数据
- 给每个问题一个“类型”分类，然后根据这些创建汇总表和图表。
  - 您可能想要研究漏洞类别来创建您的分类 - 它们的级别应该足够高，可以将漏洞分组在一起，但又足够具体，以便将问题分配到类别中是有用的。

# 12-范围

报告中的另一个必不可少且极其关键的部分是范围定义章节。该章节应明确阐述拟开展的工作，并传达评估的边界。至关重要的一点是，本章节内容应与提议的范围保持一致。

我所观察到的此类表达方式的两个极端风格如下：

- 以散文形式书写，包含项目列表及少量表格
- 完全采用表格格式，仅呈现关键信息

一如往常，所有报告的撰写方式各有不同，且往往混合使用这两种风格。只要关键信息表述清晰，都是可以接受的。

文档中应包含的关键信息如下：

- 评估的开始和结束日期
  - 在工作上花费的可选天数（如果这适用于您）
- 评估团队中的人员列表
  - 例如，对附录中列表的引用
- 测试内容的名称，以及可能的描述
  - 包括任何测试环境信息（如果适用）
- 具体测试内容的列表，可能按工作阶段划分。这方面的一些例子可能是：
  - Web 应用程序评估
    - https://pppp.dddddd.dddddd/test
    - https://cccc.dddddd.dddddd/test
  - AWS 评估
    - AWS 账户 ID AKIAIOSFODNN7EXAMPLE、AKIAIOSFODNN7EXAMPLE2
  - Web 应用程序的代码审查评估
    - 前端 - 提交哈希 4e725f6e656edddffabc1234567890abcd123456
    - 后端 - 提交哈希 1234abcd5678efgh9012ijkl3456mnop7890qrst
  - 外部基础设施评估
    - xxx.10.122.123
    - xxx.10.122.124
    - xxx.10.122.125
  - 文档审查
    - policies.zip - SHA256 校验和： a594a6d13eb6b77f97b1fe3627bdfd58f420ca749b1158ae9082dc1988ba52d

有许多情况下，将较大工作范围的内容放入附录，然后在此部分进行引用更为适宜。在我的经验中，尤其当代码审查评估涉及数十个仓库时，这种方式是必需的，因为这些内容无法整洁地容纳于一页之内。

接下来，我们将通过两种格式来了解这些信息可能呈现的样子。

## 表格格式

表格格式相当简洁，具有多个优点。与较为冗长的范围段落相比，需填写的信息较少。这种数据很可能可以在排程或销售系统中预先定义，然后自动导入您使用的模板或报告工具中。

以下是 OGPatientBooking 评估的外观：

| 评估开始 | 2024-01-01                                     |
| -------- | ---------------------------------------------- |
| 评估结束 | 2024-01-15                                     |
| 评估小组 | 卢克·罗杰森                                    |
|          | 丹尼尔·詹宁斯                                  |
| 评估名称 | OGPatientBooking Web 应用程序和 AWS 审核       |
| 工作阶段 | Web 应用程序评估                               |
|          | AWS 配置审查                                   |
| 范围     | Web 应用程序： https://hhhh.xxxxxxxxx.bbb      |
|          | AWS 账户：AKIAIOSFODNN7EXAMPLE                 |
| 测试环境 | 在生产环境中测试医院帐户 （test-hospital-2）。 |

尽管这种方式极其精炼且易于填写，但它未能捕捉到在工作说明书中可能已讨论过的评估关键关注点或目标。当然，你也可以在这里包含这些信息，但这样做可能会使表格格式显得杂乱或臃肿。

## 散文格式

这是我更喜欢的格式。它允许更多的自定义，同时还能够从模板生成。

没有任何评估是完全相同的，客户关心的目标、关注领域或场景也会有所差异。采用此格式，我们可以更自由地表述我们以客户易于理解的方式评估了特定细节，而非将其挤在表格之中。

以下是这种较为详尽版本的一个示例：

> OGPatientBooking 联系了 ogSec，要求对其平台进行评估。主要目标是确认是否存在任何 Web 应用程序漏洞，并对其 AWS 环境进行配置审查。在项目启动电话会议期间商定的一项具体要求是审查静态和传输加密的使用情况，并指出是否存在与这些领域相关的漏洞。
>
> 评估于 2024-01-05 和 2024-01-15（含）进行，由 Luke Rogerson 和 Daniel Jennings 进行。
>
> 评估范围包括以下几个阶段的工作：
>
> \- 生产 AWS 账户的 AWS 配置审查 （AKIAIOSFODNN7EXAMPLE）
>
> \- 生产环境中 OGPatientBooking 应用程序的 Web 应用程序评估 （https://hhhh.xxxxxxxxx.bbb）
>
> \- 请注意，提供的是测试医院实例，而不是现有客户的实例 （test-hospital-2）
>
> 应该指出的是，拒绝服务测试不在本次评估的范围内。

上述内容并不算过于繁复，但它确实概述了进行评估的动机，包括要求审视静态存储和传输过程中的加密情况。此外，它还强调我们在此次合作期间不会进行任何拒绝服务类型（DoS）的测试（这一点虽然很容易添加到表格格式中）。

文本主体内容将主要源于与客户的工作说明书（Statement of Work, SOW）及启动会议（理想情况下，仅在双方书面达成一致的情况下承诺对特定范围进行变更）。

## 复制粘贴自工作说明书？

有些人可能倾向于从提案或工作说明书中直接复制粘贴文本。虽然在合理范围内可以这样做，但必须谨慎处理。如果您希望确保时态和格式的一致性，那么复制进来的文本必须适应报告的格式和写作风格。因此，请务必像对待刚写完的文字一样审查复制的内容，并将其调整以与文档其余部分保持一致。

## 课程小结

范围章节的内容应取自客户已签字确认的提案或工作说明书。如本课所述，展示这些信息有多种方法，任何一种方式都是可接受的。需要牢记的最重要事项是保持信息清晰无歧义，且包含已在客户签字确认的工作范围或提案中涵盖的所有内容。



# 13-范围 - 练习

在上一课中，我们介绍了在报告文档中呈现范围界定信息的两种常用格式。应始终包括范围，以显示在评估期间执行了哪些操作，并反映在报告中。

让我们来做一些练习。

**反思练习**

反思您阅读或撰写的报告。范围部分的格式如何？是散文、表格格式，还是两者兼而有之？考虑所提供的范围信息的清晰度和完整性。如何改进本节的表述方式，以便更好地理解和与评估协议保持一致？

**一般练习**

编写 Goal Gobbler 和 Retail Rodeo 评估的范围部分。为两者制作表格和散文示例。请随意编造或包含可能需要的任何其他信息。

**超越练习**

创建一个清单或模板，用于在评估准备期间收集所有必要的范围信息。该清单应确保预先收集所有关键细节，以便提前包含在报告的范围部分。

# 14-注意事项

注意事项部分（也称为“测试限制”部分）是工作说明书中无法完成或仅部分完成的任何元素的详细信息的地方。原因和时间也在这里被捕捉到。这是在评估结束后发生任何争议时必须完成的关键。

以下是可能导致评估覆盖范围或完成受到影响的一些原因：

- 客户要求我们停止测试数小时或数天
- 应用程序或环境要么不可用，要么速度非常慢
- 未提供凭据来对环境或应用程序进行身份验证（根本没有提供，或者在一段时间后提供）
- 属于范围的关键功能或正在运行的服务无法正常运行或丢失
- 访问测试物理位置的问题
- 范围界定问题
  - 完成工作所需的努力超出了工作说明中概述的预期
  - 所需的评估与工作说明中概述的评估不同
- 等等

在反思上述任何一项时，请确保您遵守事实，并提供影响评估的关键事件的任何日期和时间信息。

此外，请务必跟踪将来发生争议时可能需要的任何证据。这可能是这样的：

- 来自任何重要工具的日志（漏洞扫描结果、代理日志等）
- 应用程序或服务的屏幕截图显示错误，或在预期时以其他方式丢失（最好是时间戳）
- 来自客户或第三方的电子邮件

最后，如果在评估期间出现重大中断，但您能够在不影响覆盖范围的情况下完成评估，则无需在本节中发表评论。**只有当**工作陈述的某些部分无法完成时，才应编写本节。

## 注意 - 保持冷静，保持专业

当测试没有按计划进行或由于各种问题而难以完成时，可能很想使用报告的这一部分来发泄。不要这样做。这令人难以置信地不专业，可能会影响与客户的关系。

如前所述：坚持事实。只要捕捉到重要的细节和事件，他们就可以在发生争议时为自己说话。

## 例子

假设 OGPatientBooking 应用程序的测试没有按计划进行，原因如下：

- 我们已经有几天没有收到申请的凭据了
- 应用程序速度慢且无响应
- 客户对邮件不予回复（即便回复，其言辞也颇为生硬且粗鲁）。

### 坏

让我们先看一个不好的例子：

> 由于 OGPatientBooking 未及时提供凭据，测试应用程序损失了两天时间。
>
> 此外，当我们请求帮助时，OGPatientBooking 没有回复我们的电子邮件，因为在整个测试过程中，该应用程序的速度非常慢且没有响应。这种缺乏合作使测试过程非常具有挑战性。
>
> 这两件事都意味着申请的全面覆盖受到严重影响，评估无法在时间范围内完成。客户应确保他们为未来的任何评估做好更充分的准备，以免浪费时间。

这不仅包含无法测试的内容的有限细节，而且以一种将评估的缺点归咎于客户的方式编写。虽然通常情况下，当测试不顺利时这不是我们的错，但我们仍然不应该为此责怪客户。在报告中和报告外都应完全避免这种情况。

### 好

下面是一个更好的示例：

> 直到评估开始后 2 天（2024 年 5 月 7 日上午），才提供用于测试应用程序认证方面的凭据。
>
> 此外，在整个评估过程中，应用程序会周期性地一次无响应几分钟。除此之外，服务器需要几秒钟来响应请求。这意味着许多依赖于快速连续向服务器发送多个请求的测试无法成功完成或花费大量时间。因此，无法对整个应用程序完成某些漏洞的测试。在整个评估过程中，OGPatientBooking 被告知应用程序的行为。
>
> 由于上述原因，Web 应用程序的测试覆盖率受到了重大影响。以下列表从测试角度显示了应用程序主要区域的高级状态：
>
> 全面覆盖
>
> 基本测试，例如但不限于：
>
> - 未经身份验证的 Web 应用程序测试
> - TLS/SSL测试
> - Web 服务器配置问题
> - 审查前端资产
> - 认证
> - 办理登机手续的流程功能
>
> 部分承保
>
> - 患者通信功能
> - 患者更新功能
> - 无或有限承保范围：
> - 纳维医院
>
> 鉴于上述部分和有限的覆盖范围，建议进行单独的评估，以审查受影响的区域和特征。
>
> 评估期间重大影响的时间表可在附录第x.x节中找到。
>
> 请注意，AWS 配置审查已顺利完成。

此版本有几项改进：

- 写作风格避免了责备客户的措辞
- 提供了有关测试如何受到影响的更多详细信息
- 哪些具体因素受到影响 - 这可用于可能的后续评估
- 在附录中加入时间表既有助于覆盖我们自己，也有助于告知客户在他们想进行自己的调查时发生了什么。如果这种类型的部分很长，在附录中可能会更好。
- 呼吁其他元素不受影响是一个很好的选择，因为它有点说“这并不全是坏事，我们确实设法覆盖了范围的其余部分”

这个例子显然非常彻底，你可能会得到一些更简洁的东西。但是，如果您需要回来查看最初无法查看的内容，那么在这些类型的场景中进行更精细的细分将对您的团队有所帮助，否则他们可能不得不再次评估所有内容（尽管这不是坏事）。

如果评估进展不顺利，最好在发生问题时跟踪出错的地方，以便本节尽可能简单编写。考虑以简单的项目符号格式制作每日笔记，如果需要，以后可以将其转换为本节。

## 限时评估

如果您正在接受被认为是“尽力而为”或“有时间限制”的评估，那么填写一个简单的声明来解释评估是在压缩的时间范围内进行的，这可能是合适的。

现实情况是，几乎所有的评估都是有时间限制的，不可能或不合理地发现所有问题（并且很可能已将这种措辞添加到SoW中），但是在测试受到时间的严格约束并被明确指出的情况下，可以在本节中提及。

## 没有附加注意事项

如果评估中没有注意事项，则有两种选择：

- 要么在报告中有该部分，要么有一个简单的声明，说明没有警告
- 完全删除该部分

我倾向于保留该部分，以避免客户提出“您的警告部分发生了什么？”的后续问题，这只会产生更多我们需要回应的事情。但是，我当然看到过许多没有此部分的报告，这些报告在测试过程中可能没有问题。

## 课程总结

注意事项部分对于确保评估的任何缺陷都明确并记录在评估报告中至关重要。如果没有它，客户可能不知道您在评估过程中可能遇到的问题，以及这些问题如何影响您的工作范围，以及可以完成多少原始计划的工作范围。请记住，本节不是我们指责客户将工作未完成的责任归咎于客户，而只是记录评估期间发生的事情，这些事件影响了我们完成工作范围的能力。

# 15-注意事项 - 练习

在上一课中，我们强调了注意事项部分的重要性，尤其是在评估无法成功完成的情况下。

以下是与报告这一部分相关的一些练习。

**反思练习**

反思您参与的评估，其中评估没有按计划进行。注意事项或测试限制部分写了什么？回顾警告的呈现方式，并考虑它们是否清晰、真实和专业。该部分能否根据上一课的内容进行任何改进？

**一般练习**

这里有一些评估示例供您编写警告部分。尝试以专业的方式编写它们，而不责怪客户。如果您想添加其他细粒度的详细信息，请随时这样做。

<u>评估 1</u>

- 范围：QuantumGuard 网络安全解决方案的内部基础设施测试
- 详细信息：目的是评估 QuantumGuard 内部网络的安全性并识别漏洞。该合作持续了 10 天，针对 100 台网络设备和服务器。评估小组在评估的头3天无法进入现场，虽然可以对所有网络设备进行扫描，但无法进行进一步的普查和特定于服务的检查。

<u>评估 2</u>

- 范围：EcoSolutions Unlimited 的外部基础设施扫描
- 详细信息：客户希望在此基础结构上托管的 8 个 Web 应用程序也应该经过测试。评估范围为 5 天，扫描 25 个 IP 地址。公开了有限的服务，这意味着您只能对 Web 应用程序执行基本测试。

<u>评估 3</u>

- 范围：NexaTech Innovations， Inc. 的 Web 应用程序测试。
- 详细信息：测试的第一天没有提供证书，但能够获得全面覆盖

# 16-调查结果

报告的“发现”部分用于存储评估期间发现的漏洞、错误配置和其他安全风险。

本课的范围实际上不是关于发现本身，而是关于整个部分及其结构，正如你所想象的那样，由于这个原因，这里没有太多的东西要涵盖。

## 调查结果报告结构

对于跨单个工作阶段的评估，本节中可能不需要进行重大细分。考虑单个 Web 应用程序的 Web 应用程序测试，这可能是这样的：

> 2.2 评估结果
>
> 2.2.1 Web 应用程序评估

如果评估涵盖两个或多个 Web 应用程序，则这些应用程序可以由单个阶段涵盖，因此在单个部分中。这确实使报告更容易，因为两个应用程序中存在的发现可以写在单个发现中，但是，最好询问您的客户应该如何处理这个问题。根据我的经验，特定的团队可能负责特定的应用程序，并且对影响报告中的内容的内容进行清晰的细分通常对客户来说更可取（特别是如果这些发现在将它们放入 JIRA 之类的东西之前要拆分）。在这种情况下，按如下方式单独指定它们可能更清楚：

> 2.2 评估结果
>
> 2.2.1 Alpha Web 应用程序评估
>
> 2.2.2 Beta Web 应用程序评估

如果正在执行的评估“类型”明显不同，建议将其分解为各自的领域。这样可以更轻松地突出显示应用程序不同区域中的任何结果分布（回想一下结果概述课程），以及当我们在报告的上半部分总结结果时。下面是一个示例：

> 2.2 评估结果
>
> 2.2.1 Web 应用程序评估
>
> 2.2.2 外部基础设施评估
>
> 2.2.3 服务器构建审查

在测试期间，上述每个元素的多个元素也可能发生，并且可能对您的客户端进行分解更有用。对于较大的作业，请仔细考虑这一点，因为额外报告编写的开销可能会影响您的测试，但是最好考虑客户在这种情况下的偏好，理想情况下，工作范围应该有足够的报告时间，以便在他们自己的部分中涵盖这些项目。下面是一个示例：

> 2.2 评估结果
>
> 2.2.1 Alpha Web 应用程序评估
>
> 2.2.2 Alpha 服务器构建回顾
>
> 2.2.3 Alpha 外部基础设施评估
>
> 2.2.4 Beta Web 应用程序评估
>
> 2.2.5 Beta 服务器构建回顾
>
> 2.2.6 测试版外部基础设施评估

最后，考虑这些部分的命名。当与工作范围一起审查时，每个阶段的内容可能很明显，但是如果这些阶段的命名不明确，情况可能并非如此。确保相位名称唯一且清晰，但也要尽可能简洁。

## 对评估阶段进行编号

给特定的测试阶段一个数字并不是我在所有报告中看到的。不过，它确实有几个好处。下面是前面示例的样子：

> 2.2 评估结果
>
> 2.2.1 第 1 阶段 - Alpha Web 应用程序评估
>
> 2.2.2 第 2 阶段 - Alpha 服务器构建审查
>
> 2.2.3 第 3 阶段 - Alpha 外部基础设施评估
>
> 2.2.4 第 4 阶段 - Beta Web 应用程序评估
>
> 2.2.5 第 5 阶段 - Beta 服务器构建回顾
>
> 2.2.6 第 6 阶段 - Beta 版外部基础设施评估

这可能会增加报告模板的复杂性，但具有以下好处：

- 在讨论报告时，您可以说“请参阅第 1 阶段的调查结果”
- 如果您想将查找标识符与特定阶段联系起来，则可以在查找标识符中使用此编号 - 我个人认为最好为查找设置一个简短的唯一标识符，而不是合并阶段号。

## 一个部分用于复杂的工作？

我在一些报告中看到，已经完成了广泛而复杂的评估，但调查结果尚未分解为单独的阶段。取而代之的是，使用单个部分来存储所有结果。这使得客户更难消化报告中的信息，也使评估团队更难总结在哪里发现了什么。

在这里使用您的最佳判断，何时只有一个阶段，但请考虑：

- 询问客户在某些领域使用多个阶段是否有意义。
- 如果正在审查多个评估“类型”（如前面的示例中所述），是否应该将它们分解？（可能）
- 如果报告将受益于其他部分（例如：调查结果概述、执行摘要或建议部分）中调查结果的逻辑隔离

需要注意的一件事是，不同的客户团队可能负责评估的不同领域。例如，如果在一个报表中执行了 Web 应用程序评估和基础结构评估，并且每个区域都由单独的团队管理，则如果将结果分开，则对他们来说可能会更容易。

## 常见发现部分

我参加过一些评估，也看到过一些评估，其中许多领域的共同主题浮出水面。在报告主题时，最好将它们拿出来单独报告。

在具体的发现和主题之间有一条线。发现与漏洞的特定或小实例集合有关，而主题与可能跨越多个评估阶段的更高级别（可能缺少一些主要组件或缺少战略安全实践）有关。如果在它所处的每个评估阶段都提出这个问题，那么在查看清单中的所有调查结果时，这将是一个重复的结果。

调查结果 - 可能保留在他们自己的评估阶段：

- 跨不同代码评审评估阶段的代码中的多个凭据实例
- 跨不同内部网段使用的 TLS 版本 1.0
- 影响多个 Web 应用程序的跨站点脚本

主题 - 将在他们自己的部分提出：

- 凭据管理不善（如果在单独的代码审查阶段在代码中看到凭据实例）
- 缺乏第三方渗透测试（这将是广泛的，可能会影响多个阶段）
- 缺乏漏洞扫描（可能影响多个网络）

在决定是否应该在“共同发现/领域”提出某些问题时，您可以问自己的一个问题是：“如果我分多个阶段报告这个问题，补救措施是否**完全相同**？例如，结果“不存在 Web 应用程序防火墙 （WAF）”可能会对正在测试的多个应用程序使用相同的 WAF，因此您不希望在每个评估阶段重复此结果。

不管这个建议如何，在一个地方提出共同的发现可能是可以的，我已经多次看到代码中的秘密在“共同发现”部分提出。因此，再一次，使用您自己的判断并与您的客户合作，以确保以正确的方式处理这种方法。

可能还有另一种选择，您可以分解战略指南和发现的具体实例。这可能取决于您如何理解您的客户将如何处理您的发现。

再次使用代码示例中的机密时，可能会有如下内容：

> 2.2 评估结果
>
> 2.2.1 第 1 阶段 - 代码审查常见结果
>
> 糟糕的凭证管理
>
> 2.2.1 第 2 阶段 - 身份验证堆栈的代码审查
>
> 代码中的机密
>
> 2.2.2 第 3 阶段 - 产品目录微服务的代码审查
>
> 代码中的机密

这样，客户端可以修正阶段 2 和阶段 3 中的发现，以烧毁代码中发现的凭据的特定实例，并单独处理更具战略性的解决方案（在第 1 阶段中概述）的实现。

## 课程总结

在这个简短的课程中，我们考虑了如何最好地在逻辑上将发现彼此分开。我们应该考虑客户可能如何处理即将到来的发现。如果不同的团队负责审查不同的应用程序或工作阶段，那么将它们分开是有意义的——因此请在此处与您的客户联系以获得指导。在提出主题发现时，可能会有一个专门的阶段，用于审查多个相同的“类型”事物（例如，审查多个代码库或 Web 应用程序）。使用您的最佳判断来确定是否应该针对发现相同错误的每个区域同时提出共同发现和特定发现。

# 17-调查结果 - 练习

正如在上一课中所讨论的，为了我们的客户的可读性，在需要时将调查结果分成不同的部分是重要和体贴的。

以下是一些相关练习：

**反思练习**

- 反思您最近阅读或撰写的报告。考虑调查结果的结构：是否按评估阶段或类型明确区分调查结果？这种结构是否有助于理解和解决调查结果？想一想，如果有机会，根据上一课所涵盖的内容，如何重新组织调查结果。
- 想想你参与的评估，其中的结果跨越了多个领域或工作类型（例如，Web 应用程序、服务器构建、外部基础设施）。这些发现是如何记录的？思考将发现分成不同阶段或单个部分是否更有效地将发现传达给客户。

# 18-附录

报告文档的附录部分可用于存储许多内容。它的用法在行业内各不相同，有时在其位置或之前使用称为“补充数据”的类似部分。出于本课程的目的，我们将坚持使用单个部分。

从广义上讲，以下类型的信息可以存储在这里（可能还有其他一些类别）：

- 用于保存有关评估的扩展元数据信息的部分。例如：
  - 评估小组
  - 风险评级概览
  - 方法
  - 扩展范围界定信息
- 从测试本身创建的信息。例如：
  - 测试工具输出
  - 概念验证
  - 攻击链

对于从测试中生成的信息，使用附录的主要原因是确保结果不会因需要大量滚动的无休止的工具输出而臃肿，从而降低结果的可读性。

让我们在下面浏览一些值得注意的例子。

## 评估小组

“杂项数据和部分”课程中提到了这一部分。让我们在这里再次回顾一下作为提醒。

有时，参与评估的个人名单会列在附录中，有时也会在范围界定部分提及。

再一次，这是它可能的样子：

| **名字**               | **标题**       | **认证/注意事项**                      |
| ---------------------- | -------------- | -------------------------------------- |
| 卢克·罗杰森            | 导演           | 进攻性安全认证专家 （OSCP）            |
| 陈婷婷                 | 安全分析师     | 认证信息系统安全专家                   |
| 艾哈迈德·赛义德        | 高级顾问       | 认证道德黑客 （CEH），CISSP            |
| 莎拉·约翰逊            | 主任审计师     | ISO 27001主任审核员                    |
| 卡洛斯·拉米雷斯        | 网络工程师     | 思科认证网络助理 （CCNA）              |
| 埃琳娜·彼得罗娃        | IT经理         | 项目管理专业人员 （PMP）               |
| 拉杰·帕特尔            | 程序员         | AWS 认证解决方案架构师                 |
| 田中由纪               | 网络安全主管   | GIAC Security Essentials 认证 （GSEC） |
| 大卫·奥康纳            | 首席信息安全官 | 网络安全硕士，CISSP                    |
| 伊莎贝拉·罗西          | DevOps工程师   | 认证 Kubernetes 管理员 （CKA）         |
| 艾莎·曼苏尔            | 风险经理       | 认证风险和信息系统控制 （CRISC）       |
| 西奥·伯纳德            | 事件响应者     | GIAC 认证事件处理人员 （GCIH）         |
| 王婷婷                 | 数据保护官     | 注册数据隐私解决方案工程师 （CDPSE）   |
| 贾斯珀·辛格            | 合规官         | 认证信息隐私专家 （CIPP/E）            |
| 格蕾丝·金（Grace Kim） | 云架构师       | AWS 认证安全性 - 专业                  |

在范围界定部分列出所有这些人可能会占用很多空间，因此将此列表分解为报告中的单独部分可能更合适。

## 风险评级概览

一些报告概述了所使用的风险评级系统及其在高层次上的工作原理。这是为了告知读者每个严重性级别意味着什么，以及如何解释调查结果中的相关风险。本课程的其他地方介绍了风险评级本身，但下面是一个示例：

> 本报告使用标准风险评级系统来描述调查结果。使用的风险评级为“严重”、“高”、“中”和“低”。为了阐明评估期间提出的其他意见以及任何良好做法，可以使用“信息”和“良好”评级。
>
> 风险的细分及其高级解释如下：
>
> | **风险** | **解释**                                                     |
> | -------- | ------------------------------------------------------------ |
> | 危急     | 具有重大风险的问题可能导致整个系统泄露、大规模数据泄露或导致重大运营问题。这些问题可能很容易被新手攻击者利用或检测到。甚至可能是已知的漏洞可以在线获得，从而增加了攻击的可能性。 |
> | 高       | 高风险问题可能会导致严重后果，例如数据泄露或业务运营受到严重干扰。这些问题可能需要特定条件才能利用，或者需要从网络或用户权限的角度适当定位攻击者。 |
> | 中等     | 这些问题可能对系统和数据造成有限影响。这些问题可能需要一些专业知识来利用或影响可能对整体环境不重要的系统。 |
> | 低       | 低风险问题本身不太可能造成重大伤害，但可以用作更重要的更大攻击链的一部分。这些问题可能影响有限或难以利用。 |
> | 信息     | 在评估过程中提出了一项意见，即虽然不构成安全风险，但值得注意的是，它使读者了解偏离建议准则的特定方面或做法。 |
> | 好       | 用于突出显示正在使用的良好安全实践。                         |

## 方法

虽然许多组织将一些方法信息放在报告的上半部分（通常在范围附近），但方法出现在附录中的情况并不少见。

我不会介绍方法可能是什么样子的，因为它偏离了报告写作之外，进入了评估本身，因此超出了本课程的范围。如果您对给定评估的方法部分可能是什么样子感兴趣，请在线搜索一些示例。

另一种可能减少报告页数的选项是，从附录中的某个部分或报告的其他部分链接到报告中的适用方法，以访问您组织的网站。这样，组织可以向潜在客户展示他们的测试方法，也可以将该链接用作报告中的参考。

## 工具输出

使用附录的主要原因之一是存储工具输出或其他测试数据，否则这些数据会使特定发现变得混乱。

重要的是要记住，客户不想要 1,000 页的报告，因此请仔细考虑您在本节中输入的内容：

- 首先，尝试截取/压缩/总结工具输出，以便它可以在发现中使用，同时确保它仍然适合作为证据
- 如果工具输出突出显示了多个位置的特定错误配置或漏洞的许多实例，您能否将其导出为电子表格并将其与报告一起提供？（别忘了在调查结果中参考本文档）
- 如果这些用例都不起作用，请将工具输出放在附录部分。使用可读的格式，并且不会占用超过需要的页面。
  - 如果您需要将其分解为多个小节以便于阅读或浏览文档，请这样做

不要害怕将补充文件传递给客户。大多数工具都支持以可以轻松操作到漂亮的电子表格中的格式进行输出。这些比 PDF 文件中跨越多个页面的表格更容易使用。

最后，不要忘记参考相关调查结果中的附录。我见过很多案例，客户追着我们索取更多信息，只是为了在文件中提供信息，但它与适用的调查结果无关。是的，他们本可以自己找到它，但我们应该始终尽可能地提供帮助。默认情况下，插入对相关部分的交叉引用是将附录部分与查找一起使用时应执行的操作。

## 概念验证

如果发现的问题需要多个步骤才能利用，或者编写了长时间的自定义漏洞，则最好将发现结果中的扩展详细信息移到附录中。

这一概念也适用于将报告中的多项调查结果串联起来。有时，攻击链本身可以作为单独的发现提出，然后引用到本附录部分。这将显示用于描述端到端攻击的所有步骤、示例和证据。

## 扩展范围界定信息

有时，参与的范围很复杂或很长（或两者兼而有之），将其单独存储在附录中，然后从范围界定部分引用它是有意义的。同样，这是为了避免无休止的页面使报告的重要部分混乱。虽然这并不是说这些详细的范围界定信息不重要，但确实如此。但是，当将其分解为附录中的专用部分时，它更清晰，更具可读性。

以下是附录中可能更好的几个范围界定信息示例。

### 代码审查范围界定

您正在执行漫长而复杂的代码评审评估，该解决方案由数十个存储库组成。对于每个存储库，您都有一个名称、URL 和一个提交哈希。

下面是它可能的样子：

| **存储库名称**      | **存储库 URL**                                 | **提交哈希** |
| ------------------- | ---------------------------------------------- | :----------: |
| AlphaCore           | https://github.com/example/AlphaCore           |   a1b2c3d4   |
| BetaEngine          | https://github.com/example/BetaEngine          |   e5f6g7h8   |
| GammaService        | https://github.com/example/GammaService        |   i9j0k1l2   |
| DeltaAPI            | https://github.com/example/DeltaAPI            |   m3n4o5p6   |
| EpsilonFramework    | https://github.com/example/EpsilonFramework    |   q7r8s9t0   |
| ZetaLibrary         | https://github.com/example/ZetaLibrary         |   u1v2w3x4   |
| EtaModule           | https://github.com/example/EtaModule           |   y5z6a7b8   |
| ThetaComponent      | https://github.com/example/ThetaComponent      |   c9d0e1f2   |
| IotaUtils           | https://github.com/example/IotaUtils           |   g3h4i5j6   |
| KappaTools          | https://github.com/example/KappaTools          |   k7l8m9n0   |
| LambdaServices      | https://github.com/example/LambdaService       |   a8b9c0d1   |
| MuInterfaces        | https://github.com/example/MuInterfaces        |   e2f3g4h5   |
| NuScripts           | https://github.com/example/NuScripts           |   i6j7k8l9   |
| XiFunctions         | https://github.com/example/XiFunctions         |   m0n1o2p3   |
| OmicronHelpers      | https://github.com/example/OmicronHelpers      |   q4r5s6t7   |
| PiComponents        | https://github.com/example/PiComponents        |   u8v9w0x1   |
| RhoUtilities        | https://github.com/example/RhoUtilities        |   y2z3a4b5   |
| SigmaLib            | https://github.com/example/SigmaLib            |   c6d7e8f9   |
| TauModules          | https://github.com/example/TauModules          |   g0h1i2j3   |
| UpsilonAPIs         | https://github.com/example/UpsilonAPIs         |   k4l5m6n7   |
| PhiService          | https://github.com/example/PhiService          |   p8q9r0s1   |
| ChiTools            | https://github.com/example/ChiTools            |   t2u3v4w5   |
| PsiModules          | https://github.com/example/PsiModules          |   x6y7z8a9   |
| OmegaLib            | https://github.com/example/OmegaLib            |   b0c1d2e3   |
| AlphaNet            | https://github.com/example/AlphaNet            |   f4g5h6i7   |
| BetaStream          | https://github.com/example/BetaStream          |   j8k9l0m1   |
| GammaSync           | https://github.com/example/GammaSync           |   n2o3p4q5   |
| DeltaAccess         | https://github.com/example/DeltaAccess         |   r6s7t8u9   |
| EpsilonCompute      | https://github.com/example/EpsilonCompute      |   v0w1x2y3   |
| ZetaData            | https://github.com/example/ZetaData            |   z4a5b6c7   |
| EtaStorage          | https://github.com/example/EtaStorage          |   d8e9f0g1   |
| ThetaProcess        | https://github.com/example/ThetaProcess        |   h2i3j4k5   |
| IotaFlow            | https://github.com/example/IotaFlow            |   l6m7n8o9   |
| KappaConnect        | https://github.com/example/KappaConnect        |   p0q1r2s3   |
| LambdaControl       | https://github.com/example/LambdaControl       |   t4u5v6w7   |
| MuInterfaceDesign   | https://github.com/example/MuInterfaceDesign   |   x8y9z0a1   |
| NuAutomation        | https://github.com/example/NuAutomation        |   b2c3d4e5   |
| XiVisualization     | https://github.com/example/XiVisualization     |   f6g7h8i9   |
| OmicronAnalysis     | https://github.com/example/OmicronAnalysis     |   j0k1l2m3   |
| PiSimulation        | https://github.com/example/PiSimulation        |   n4o5p6q7   |
| RhoIntegration      | https://github.com/example/RhoIntegration      |   r8s9t0u1   |
| SigmaTesting        | https://github.com/example/SigmaTesting        |   v2w3x4y5   |
| TauNetworking       | https://github.com/example/TauNetworking       |   z6a7b8c9   |
| UpsilonSecurity     | https://github.com/example/UpsilonSecurity     |   d0e1f2g3   |
| PhiDatabase         | https://github.com/example/PhiDatabase         |   h4i5j6k7   |
| ChiFirmware         | https://github.com/example/ChiFirmware         |   l8m9n0o1   |
| PsiCloud            | https://github.com/example/PsiCloud            |   p2q3r4s5   |
| OmegaAnalytics      | https://github.com/example/OmegaAnalytics      |   t6u7v8w9   |
| AlphaVision         | https://github.com/example/AlphaVision         |   x0y1z2a3   |
| BetaMachineLearning | https://github.com/example/BetaMachineLearning |   b4c5d6e7   |

显然，这是一个相当大的表格，可以放在报告的重要部分，并且可能会跨越多页。

### 内部基础设施评估

您正在参与对客户内部基础设施的大量审查。该审查跨越多个区域、站点和隔离网络。每个站点都细分为生产、预生产、测试、开发和企业 IP 地址范围。10个国家正在接受测试，每个国家有1至5个地点。

下面是这可能是什么样子的：

| **国家**    | **站点编号** | **网段** | **IP 地址范围**           |
| ----------- | ------------ | -------- | ------------------------- |
| 国家 1      | 站点 1       | 生产     | 10.1.1.0 - 10.1.1.255     |
| 国家 1      | 站点 1       | 前期制作 | 10.1.2.0 - 10.1.2.255     |
| 国家 1      | 站点 1       | 测试     | 10.1.3.0 - 10.1.3.255     |
| 国家 1      | 站点 1       | 发展     | 10.1.4.0 - 10.1.4.255     |
| 国家 1      | 站点 1       | 企业     | 10.1.5.0 - 10.1.5.255     |
| 国家 1      | 站点 2       | 生产     | 10.1.6.0 - 10.1.6.255     |
| 国家 1      | 站点 2       | 前期制作 | 10.1.7.0 - 10.1.7.255     |
| 国家 1      | 站点 2       | 测试     | 10.1.8.0 - 10.1.8.255     |
| 国家 1      | 站点 2       | 发展     | 10.1.9.0 - 10.1.9.255     |
| 国家 1      | 站点 2       | 企业     | 10.1.10.0 - 10.1.10.255   |
| 国家 2      | 站点 1       | 生产     | 10.2.1.0 - 10.2.1.255     |
| 国家 2      | 站点 1       | 前期制作 | 10.2.2.0 - 10.2.2.255     |
| 国家 2      | 站点 1       | 测试     | 10.2.3.0 - 10.2.3.255     |
| 国家 2      | 站点 1       | 发展     | 10.2.4.0 - 10.2.4.255     |
| 国家 2      | 站点 1       | 企业     | 10.2.5.0 - 10.2.5.255     |
| 国家 2      | 站点 2       | 生产     | 10.2.6.0 - 10.2.6.255     |
| 国家 2      | 站点 2       | 前期制作 | 10.2.7.0 - 10.2.7.255     |
| 国家 2      | 站点 2       | 测试     | 10.2.8.0 - 10.2.8.255     |
| 国家 2      | 站点 2       | 发展     | 10.2.9.0 - 10.2.9.255     |
| 国家 2      | 站点 2       | 企业     | 10.2.10.0 - 10.2.10.255   |
| 国家 3      | 站点 1       | 前期制作 | 10.3.2.0 - 10.3.2.255     |
| 国家 3      | 站点 1       | 测试     | 10.3.3.0 - 10.3.3.255     |
| 国家 3      | 站点 1       | 发展     | 10.3.4.0 - 10.3.4.255     |
| 国家 3      | 站点 1       | 企业     | 10.3.5.0 - 10.3.5.255     |
| 国家 3      | 站点 2       | 生产     | 10.3.6.0 - 10.3.6.255     |
| 国家 3      | 站点 2       | 前期制作 | 10.3.7.0 - 10.3.7.255     |
| 国家 3      | 站点 2       | 测试     | 10.3.8.0 - 10.3.8.255     |
| 国家 3      | 站点 2       | 发展     | 10.3.9.0 - 10.3.9.255     |
| 国家 3      | 站点 2       | 企业     | 10.3.10.0 - 10.3.10.255   |
| 国家 4      | 站点 1       | 生产     | 10.4.1.0 - 10.4.1.255     |
| 国家 4      | 站点 1       | 前期制作 | 10.4.2.0 - 10.4.2.255     |
| 国家 4      | 站点 1       | 测试     | 10.4.3.0 - 10.4.3.255     |
| 国家 4      | 站点 1       | 发展     | 10.4.4.0 - 10.4.4.255     |
| 国家 4      | 站点 1       | 企业     | 10.4.5.0 - 10.4.5.255     |
| 国家 4      | 站点 2       | 生产     | 10.4.6.0 - 10.4.6.255     |
| 国家 4      | 站点 2       | 前期制作 | 10.4.7.0 - 10.4.7.255     |
| 国家 4      | 站点 2       | 测试     | 10.4.8.0 - 10.4.8.255     |
| 国家 4      | 站点 2       | 发展     | 10.4.9.0 - 10.4.9.255     |
| 国家 4      | 站点 2       | 企业     | 10.4.10.0 - 10.4.10.255   |
| 国家 5      | 站点 1       | 生产     | 10.5.1.0 - 10.5.1.255     |
| 国家 5      | 站点 1       | 前期制作 | 10.5.2.0 - 10.5.2.255     |
| 国家 5      | 站点 1       | 测试     | 10.5.3.0 - 10.5.3.255     |
| 国家 5      | 站点 1       | 发展     | 10.5.4.0 - 10.5.4.255     |
| 国家 5      | 站点 1       | 企业     | 10.5.5.0 - 10.5.5.255     |
| 国家 5      | 站点 2       | 生产     | 10.5.6.0 - 10.5.6.255     |
| 国家 5      | 站点 2       | 前期制作 | 10.5.7.0 - 10.5.7.255     |
| 国家 5      | 站点 2       | 测试     | 10.5.8.0 - 10.5.8.255     |
| 国家 5      | 站点 2       | 发展     | 10.5.9.0 - 10.5.9.255     |
| 国家 5      | 站点 2       | 企业     | 10.5.10.0 - 10.5.10.255   |
| 国家 6      | 站点 1       | 生产     | 10.6.1.0 - 10.6.1.255     |
| 国家 6      | 站点 1       | 前期制作 | 10.6.2.0 - 10.6.2.255     |
| 国家 6      | 站点 1       | 测试     | 10.6.3.0 - 10.6.3.255     |
| 国家 6      | 站点 1       | 发展     | 10.6.4.0 - 10.6.4.255     |
| 国家 6      | 站点 1       | 企业     | 10.6.5.0 - 10.6.5.255     |
| 国家 6      | 站点 2       | 生产     | 10.6.6.0 - 10.6.6.255     |
| 国家 6      | 站点 2       | 前期制作 | 10.6.7.0 - 10.6.7.255     |
| 国家 6      | 站点 2       | 测试     | 10.6.8.0 - 10.6.8.255     |
| 国家 6      | 站点 2       | 发展     | 10.6.9.0 - 10.6.9.255     |
| 国家 6      | 站点 2       | 企业     | 10.6.10.0 - 10.6.10.255   |
| 国家 7      | 站点 1       | 生产     | 10.7.1.0 - 10.7.1.255     |
| 国家 7      | 站点 1       | 前期制作 | 10.7.2.0 - 10.7.2.255     |
| 国家 7      | 站点 1       | 测试     | 10.7.3.0 - 10.7.3.255     |
| 国家 7      | 站点 1       | 发展     | 10.7.4.0 - 10.7.4.255     |
| 国家 7      | 站点 1       | 企业     | 10.7.5.0 - 10.7.5.255     |
| 国家 7      | 站点 2       | 生产     | 10.7.6.0 - 10.7.6.255     |
| 国家 7      | 站点 2       | 前期制作 | 10.7.7.0 - 10.7.7.255     |
| 国家 7      | 站点 2       | 测试     | 10.7.8.0 - 10.7.8.255     |
| 国家 7      | 站点 2       | 发展     | 10.7.9.0 - 10.7.9.255     |
| 国家 7      | 站点 2       | 企业     | 10.7.10.0 - 10.7.10.255   |
| 国家/地区 8 | 站点 1       | 生产     | 10.8.1.0 - 10.8.1.255     |
| 国家/地区 8 | 站点 1       | 前期制作 | 10.8.2.0 - 10.8.2.255     |
| 国家/地区 8 | 站点 1       | 测试     | 10.8.3.0 - 10.8.3.255     |
| 国家/地区 8 | 站点 1       | 发展     | 10.8.4.0 - 10.8.4.255     |
| 国家/地区 8 | 站点 1       | 企业     | 10.8.5.0 - 10.8.5.255     |
| 国家/地区 8 | 站点 2       | 生产     | 10.8.6.0 - 10.8.6.255     |
| 国家/地区 8 | 站点 2       | 前期制作 | 10.8.7.0 - 10.8.7.255     |
| 国家/地区 8 | 站点 2       | 测试     | 10.8.8.0 - 10.8.8.255     |
| 国家/地区 8 | 站点 2       | 发展     | 10.8.9.0 - 10.8.9.255     |
| 国家/地区 8 | 站点 2       | 企业     | 10.8.10.0 - 10.8.10.255   |
| 国家 9      | 站点 1       | 生产     | 10.9.1.0 - 10.9.1.255     |
| 国家 9      | 站点 1       | 前期制作 | 10.9.2.0 - 10.9.2.255     |
| 国家 9      | 站点 1       | 测试     | 10.9.3.0 - 10.9.3.255     |
| 国家 9      | 站点 1       | 发展     | 10.9.4.0 - 10.9.4.255     |
| 国家 9      | 站点 1       | 企业     | 10.9.5.0 - 10.9.5.255     |
| 国家 9      | 站点 2       | 生产     | 10.9.6.0 - 10.9.6.255     |
| 国家 9      | 站点 2       | 前期制作 | 10.9.7.0 - 10.9.7.255     |
| 国家 9      | 站点 2       | 测试     | 10.9.8.0 - 10.9.8.255     |
| 国家 9      | 站点 2       | 发展     | 10.9.9.0 - 10.9.9.255     |
| 国家 9      | 站点 2       | 企业     | 10.9.10.0 - 10.9.10.255   |
| 国家 10     | 站点 1       | 生产     | 10.10.1.0 - 10.10.1.255   |
| 国家 10     | 站点 1       | 前期制作 | 10.10.2.0 - 10.10.2.255   |
| 国家 10     | 站点 1       | 测试     | 10.10.3.0 - 10.10.3.255   |
| 国家 10     | 站点 1       | 发展     | 10.10.4.0 - 10.10.4.255   |
| 国家 10     | 站点 1       | 企业     | 10.10.5.0 - 10.10.5.255   |
| 国家 10     | 站点 2       | 生产     | 10.10.6.0 - 10.10.6.255   |
| 国家 10     | 站点 2       | 前期制作 | 10.10.7.0 - 10.10.7.255   |
| 国家 10     | 站点 2       | 测试     | 10.10.8.0 - 10.10.8.255   |
| 国家 10     | 站点 2       | 发展     | 10.10.9.0 - 10.10.9.255   |
| 国家 10     | 站点 2       | 企业     | 10.10.10.0 - 10.10.10.255 |

同样，这看起来并不漂亮，并且在报告的主要范围界定部分中会感觉非常不合适。因此，将其放入附录部分并从范围界定文件中引用它是有意义的。

## 课程总结

在本课中，我们介绍了附录中可能出现的一些常见部分。附录应用于存储可能使报告主要部分混乱的信息或作为可选阅读的信息。

在报告的正文中，力求在全面性和可读性之间取得平衡。当您认为包含某些信息会影响可读性时，可能是时候使用附录或将其移至补充文档了。

在附录中存储任何材料时，请考虑是否最好创建补充文档。在决定是否将材料列入附录或将其汇编成单独的补充文件时，应评估信息与报告内容的直接相关性和适用性。

通过使用附录和补充文件，您可以提高报告的清晰度和有效性，确保报告既能提供信息又能为读者所接受。

# 19-附录 - 练习

上一课介绍了附录中出现的几个常见部分。以下是一些练习，可以反映您对本节的体验以及如何更好地利用它（或可能使用某些工具的补充文档）。

**反思练习**

- 反思您撰写或有权访问的报告。
  - 评估小组在哪里列出？你认为这个位置有意义吗，或者在其他地方会更好？如果是这样，为什么？
  - 报告中是否有总结风险评级的部分？它在哪里，你觉得它应该搬迁吗？如果是这样，为什么？
  - 报告中是否详细说明了方法？如果是，如何以及在哪里？这个位置看起来合乎逻辑吗？如果是这样，为什么？ 
  - 如果没有提到方法，你认为它们应该包括在内吗？如果是这样，为什么？
- 想想你过去写的那些依靠工具输出来获取证据的发现。
  - 你有没有觉得一个问题由于工具输出过多而变得太长？
  - 涉及哪些工具？
  - 如何更好地压缩工具输出，还是应该将其放在附录中或作为单独的文件提供？
- 您是否在一个发现中详细描述了跨多个页面的复杂攻击？将其列入附录会更合适吗？如果是这样，为什么？ 

**超越练习**

- 想想你使用的安全工具。您熟悉他们提供的不同输出格式吗？是否可以以更易于在报告或电子表格中消化的方式导出结果？
- 选择您使用的三种具有输出格式的常用工具，并尝试将其输出处理成简洁的电子表格格式。如果您想不出一个工具，请尝试：
  - testssl
  - nmap
  - trivy


# 20-其他报告部分

在这一点上，我们已经介绍了核心部分以及它们应该包含的内容，但我想我会浏览一些额外的或不太常见的部分并讨论它们的用法。我过去看过很多其他部分，所以我会坚持使用我过去看过或使用过的部分。

我们已经介绍了一些可能出现在附录部分中的可选部分：

- 评估小组
- 风险评级概览
- 方法
- 工具输出
- 概念验证
- 扩展范围界定信息

我们将在下面介绍的部分可能更具情境性（但也可能是可选的），并且不太可能是您放在附录中的内容（尽管下面的一些将是这些示例）。

## 何时使用

在某些情况下，各种供应商报告的结构和内容非常正式，但很僵化。这可能是由于结构受到很大限制，无法确保所有报告的一致性，评估或报告的时间有限，这意味着报告没有机会偏离可接受的规范太远，甚至因为工作范围不需要额外的部分。

我撰写或审查的大多数报告确实有几个额外的部分。这主要是为了提供进一步的信息和细节，说明所审查的内容或由于特定的客户要求。

虽然与熟悉的部分保持一致的结构允许回头客找到他们希望快速查看的信息，但应考虑在标准模板中放置对客户有用的其他评论或信息。

我并不是建议仅仅为了它而写更多的报告，但如果是为了提高文档质量和客户的价值，就应该考虑。

以下是包含一些附加部分的一些高级原因：

- 客户提到，无论是在 SoW 中正式确定的，还是在临时的，他们对几个领域有担忧。对于客户来说，有一个部分来讨论这些可能会更清楚。
  - 同样，如果客户明确询问是否可以以某种方式呈现信息，您应该尽量通融
- 如果评估是有针对性的，或者只是更普遍地偏离了标准评估，则最好调整报告以添加部分，而不是尝试涵盖现有部分中的特定信息。
  - 这是我见过很多次的事情，客户要求做一些工作来回答关键问题，而得到的报告只是标准的，没有参考要求。或者将信息放在不太有意义的部分，使报告感觉好像没有正确编写。
- 如果有很多问题或答案，或者要求执行的检查列表，以更明显的方式分解它们会非常有帮助。

## 良好的观察

我有时看到，对被评估事物的“良好”行为或安全态势的分析被分解成自己的部分。这样做的动机在不同的报告中各不相同，但通常是因为客户希望从安全角度分析什么是好的。不太常见的是，测试人员在评估过程中没有发现太多错误。

原则上，这些部分是可以添加的（甚至包含在执行摘要等地方），但是，请确保您只谈论好东西，如果它们真的都是好的。

有几次，我看到顾问在有相反的证据时，在报告事情时会引起混乱。例如，有人发现其中一个页面上存在 SQL 注入漏洞，但应用程序的其余部分似乎不受此漏洞类的影响。然后，报告中发表了一条评论，表明该应用程序可以很好地抵御不受信任的输入，因为在**几乎所有**情况下，这些攻击都是不可能的。虽然这种说法可能不是假的，但它可能会误导读者，最好谨慎行事，只有在您完全确定某个错误或一类错误没有被利用时才做出这些断言（如果我无法访问评估中的代码并且无法断然排除它，我可能会完全避免说这句话， 例如）。

在这种情况下，最好评论发现的漏洞是特定的，而不是系统性的。或者换句话说，发现了单个（或少数）实例，而不是在整个应用程序中广泛存在。最好不要在“好”部分中指出这样的问题。

所以，我的建议是：

- 如果您有足够的证据证明在您正在讨论的任何类别的漏洞中都没有可利用的发现，则可以编写本节。
- 如果在您标记为安全的区域中发现了单个漏洞，请避免将其归类为“良好”。相反，将其描述为一个孤立的事件。可能会将其移出任何“好”部分。
  - 客户仍然应该检查自己是否存在我们无法发现的其他案例
  - 如果您怀疑自己没有发现错误类的所有实例，或者您怀疑是否在安全性方面给客户打及格分数，那么请不要这样做。与您的团队讨论，看看这是否合理。
- 在对安全状况进行广泛评论时要谨慎，尤其是在一些关键漏洞可能危及应用程序的整体安全性的情况下。

如果您要发表这些评论，最好将其纳入执行摘要并在高层次上发言，而不是将其分成单独的部分。

下面是一个简短的示例，说明这可能是什么样子：

> 该 Web 应用程序在许多领域都表现出强大的安全态势。在评估期间，没有发现任何发现显示 Web 应用程序在处理不受信任的用户输入方面存在缺陷。这意味着可以很好地防御几个漏洞类别，包括跨站点脚本和 SQL 注入。

请注意，虽然我已经广泛地谈到了该应用程序。我还通过说“许多领域”而不是全部来削弱我的措辞。我还说过“在评估期间”——我们不能排除在评估期间，当我们执行评估的时间有限时，我们可能会错过其他情况。

我还提到了一个范围广泛的漏洞类，然后给出了几个具体的例子。如果这是在执行摘要中，我会仔细考虑这一点，因为这对于执行摘要来说可能有点太技术性了（我会说这里的例子没问题，而不是进一步的解释）。

如果这是在执行摘要中，如果发现其他漏洞，我会按照以下内容遵循此声明：

> 尽管如此，还是发现了几个安全问题，这些问题可能会导致未经授权的各方访问用户数据。

## 关于公司

有时，评估供应商可能会在报告中专门列出一个部分来展示他们的认证和能力。通常这出现在附录部分，但我在报告的上半部分已经看到了它。

我不会花时间讨论它可能是什么样子，因为我在本节中看到了如此多的差异，但最好将其描述为您可能在网站上看到的营销材料，这些材料被提炼成一个或多个页面。

## 词汇表或关键术语

虽然一般的 Web 应用程序或基础架构评估将包含对客户和测试人员都显而易见的术语或首字母缩略词（由于他们熟悉），但在某些情况下，本节会很有用。

如果正在为第三方制作报告和/或评估的主题非常小众，通常非常欢迎将以下信息细分为参考：

- 缩略语及其各自的定义
- 关键行业术语解释
- 内部产品名称或服务说明

这通常被分解成一个简单的表格，并在整个报告中引用。它通常存储在附录中，但是，如果该部分是单页，并且为了便于参考，放在正文中会更有用，这也是可以的。

下面是一个航空公司的例子：

| **术语/缩略语**     | **定义**                                                     |
| ------------------- | ------------------------------------------------------------ |
| **缩写**            |                                                              |
| AGL                 | 地面以上 - 用于描述地面以上测量高度的术语                    |
| IFR                 | 仪表飞行规则 - 管理进行仪表飞行程序的规则                    |
| MTOW                | 最大起飞重量 - 允许飞行员尝试起飞的最大重量                  |
| **行业术语**        |                                                              |
| Fuselage            | 机翼和尾翼组件连接到飞机的主体                               |
| Yaw                 | 描述飞机机头左右运动的运动                                   |
| Lift                | 直接对抗飞机重量并将飞机保持在空中的力                       |
| **产品/服务**       |                                                              |
| SkyPulse Engine     | 虚构的下一代航空发动机，旨在提高燃油效率和减少排放           |
| AeroSync Navigation | 一个虚构的商用客机高级导航系统，具有实时天气更新和航线优化功能 |
| JetStream Analytics | 一种虚构的服务，提供数据分析，以优化航线和降低运营成本       |

至于如何决定词汇表中的内容，最好考虑报告的利益相关者技术性稍差，并且不熟悉主题。这个较低的标准将确保术语表涵盖最关键的关键术语，而不是其行业应该理解的最明显的术语。

## 问题和答案

每当客户在中期报告发布期间，甚至在评估开始时提出问题时，我通常会确保这些问题记录在报告中并得到回答。这确保了我们记录客户的询问和我们的回复，提供证据证明我们已经解决了他们的问题。

我还没有看到太多的报告这样做，但如果需要，它很简单。在附录中，甚至在报告的上半部分，格式如下：

> **问题在这里？**
>
> 在这里回答。

如果许多答案很长或需要大量不同格式的信息，则将此数据放在表格中可能不可读。

如果有很多问题，则可以选择补充电子表格，并且答案足够简洁，可以以这种格式阅读。如果这样做，请记住从主报告中引用此单独的文档。

## 某些框架的差距分析

虽然针对安全框架执行差距分析并不是本报告写作课程的真正重点，但在某些情况下，客户要求我们将差距分析结果的任一评论捆绑到典型的渗透测试报告中。

在这些情况下，表格格式最适合左侧的控件和右侧的结果。桌子上的红绿灯颜色也可能效果很好。

下面是 PCI 的示例：

| **PCI DSS控制**                                              | **评估结果**                                               |
| ------------------------------------------------------------ | ---------------------------------------------------------- |
| **要求 1：安装和维护防火墙配置以保护持卡人数据**             |                                                            |
| 1.1.2 查看防火墙和路由器配置                                 | 防火墙配置正确，但路由器配置需要更新。                     |
| **要求 2：不要对系统密码和其他安全参数使用供应商提供的默认值** |                                                            |
| 2.2.3 加密所有非控制台管理访问权限                           | 所有非控制台访问都经过加密。                               |
| **要求 3：保护存储的持卡人数据**                             |                                                            |
| 3.4 对持卡人数据在开放的公共网络上的传输进行加密             | 传输加密符合要求。                                         |
| **要求 4：对通过开放公共网络传输的持卡人数据进行加密**       |                                                            |
| 4.1 使用强大的加密和安全协议                                 | 密码学标准符合，但一些较旧的协议仍在使用。                 |
| **要求 5：使用并定期更新防病毒软件或程序**                   |                                                            |
| 5.1 在通常受恶意软件影响的所有系统上部署防病毒软件           | 防病毒软件在大多数系统上都是最新的，但某些端点缺少该软件。 |
| **要求 6：开发和维护安全的系统和应用程序**                   |                                                            |
| 6.5 解决软件开发过程中常见的编码漏洞                         | 遵循安全编码实践，但没有进行正式培训。                     |
| 6.6 确保所有面向 Web 的应用程序都受到保护，免受已知攻击      | Web 应用程序防火墙 （WAF） 已实现，但需要更新规则。        |
| **要求 7：按业务需要限制对持卡人数据的访问**                 |                                                            |
| 7.1 将系统组件和持卡人数据的访问权限限制为仅其工作需要访问的个人 | 访问控制得到很好的实施并定期审查。                         |
| **要求 8：识别和验证对系统组件的访问**                       |                                                            |
| 8.2 除了分配唯一 ID 外，还至少采用以下一种方法来验证所有用户：密码、令牌设备、生物识别等。 | 强大的身份验证机制，包括 2FA。                             |
| **要求 10：跟踪和监控对网络资源和持卡人数据的所有访问**      |                                                            |
| 10.6 查看所有系统组件的日志和安全事件，以识别异常或可疑活动  | 日志审查流程已到位，但执行不一致。                         |
| **要求 11：定期测试安全系统和流程**                          |                                                            |
| 11.3 至少每年进行一次渗透测试，并在发生任何重大变化后进行渗透测试 | 每年进行渗透测试，但在系统更改后不进行。                   |
| **要求 12：维护针对所有人员的信息安全的策略**                |                                                            |
| 12.3 建立、发布、维护和传播安全策略                          | 安全政策是最新的并传播的，但缺乏员工意识。                 |

我的偏好是：

- 将完整的结果表存储在附录部分
- 有一个像结果概述这样的部分，并制作一个通过/失败表或类似表格
- 在执行摘要部分中涵盖高层次的差距分析
  - 建议部分也可能根据评估的目标和/或取决于差距分析的结果来反映这项工作

如果针对大量控件执行差距分析，则最好将详尽的结果存储在电子表格中。对于客户端来说，这可能更容易查看，因为他们可以按控制或通过/失败进行排序。确保从主报告中引用此文档。

## 体系结构概述

概述正在评估的解决方案的架构是我做过很多次的事情，也是我在审查其他供应商工作时看到的事情。在对包含多个组件的解决方案执行分析时，这通常很有帮助，这些组件通常是在内部构建的一个或多个组件。

此处的一个常见示例是多个服务支持的 Web 应用程序（如 OGPatientBooking 示例所示）。

本部分的目的并不是真正讨论安全问题，而是从组件、其组织和核心数据流的角度描述解决方案。

像往常一样，没有关于如何将本节放在一起的规则，但我的建议是：

- 首先介绍正在评估的内容和主要组成部分
- 创建一个图表，以显示主要组件和关键数据流
- 描述每个组件及其在更广泛的解决方案中的功能
  - 这应该包括关于它们与哪些其他组件或第三方系统通信的评论

这是本节的一个基本示例，包括一个非常粗略的图表。

> OGPatientBooking 应用程序遵循典型的现代 Web 应用程序体系结构。该解决方案在 Amazon AWS 中运行，并与多个第三方组件进行通信。
>
> 下图显示了解决方案的高级体系结构：
>
> ![img](https://raw.githubusercontent.com/B1ueD0g/Picture/main/202404231959020.png)
>
> 该解决方案的前端和后端是分开的，React 框架为面向用户的应用程序提供支持，Java Spring 应用程序为前端提供 REST 服务。管理员和标准用户都与同一个应用程序前端进行交互，尽管使用两个截然不同的 UI 视图。
>
> 整个平台使用三个主要数据存储：
>
> - MySQL是应用程序的主要数据存储，负责处理所有医院的所有预订信息。
> - Redis 用作会话缓存以提高性能。
> - KMS 用于存储运行时机密以及每家医院的凭据到其后端 EMR 解决方案。
>
> 该解决方案与少量外部服务进行通信。这包括：
>
> - 向患者发送提醒和其他通知的短信提供商。
> - 具有相同功能的电子邮件提供商，以及具有各种通知功能的管理员的电子邮件提供商。
> - EMR系统用于提取有关患者的其他信息，这些信息部分用于预订功能，但也促进了“患者通信”功能，患者可以在其中查看测试结果并阅读医生的消息。

当我不得不编写本节时，我会尽可能地利用客户端的现有图表。这在评估过程中节省了大量时间，因为制作这些（并确保它们看起来不错 - 与上面的示例不同）可能很耗时。如果您不经常使用图表工具，这可能意味着需要更长的时间。

如果您确实必须制作图表，请考虑保持其简单、可读和易懂。如果您需要使用颜色，请坚持使用柔和和的色调，以使读者的眼睛更容易。

在考虑解释架构图所需的深度时，请坚持事物是什么以及它们的主要功能。避免过多地进入架构概述的“工作原理”描述。对于非常复杂的系统，最好用几个图表来说明解决方案。上述格式可用于多个图表，假设它们覆盖不同的区域，或者它们位于不同的深度。

## 数据流图

数据流图通常用于可视化解决方案中的组件如何相互交互，以及信息流、处理和存储的方式。这些关系图与体系结构关系图相似，但略有不同，因为数据流本身是要显示的目标，而不是显示系统的组件。

下面是上一课中显示 OGPatientBooking 应用程序的数据流的图表：

![img](https://raw.githubusercontent.com/B1ueD0g/Picture/main/202404231959831.png)

请注意，此图还显示了信任边界（红色虚线），它显示了数据越过接收组件可能将数据视为不受信任的点的点。这在威胁模型图上更为常见。

我不打算在数据流图中提供速成课程，但这里概述了每个组件的含义：

![img](https://raw.githubusercontent.com/B1ueD0g/Picture/main/202404231959695.png)

## 威胁模型

威胁建模是梳理针对应用程序或解决方案的所有关键威胁的绝佳方法，既可以确保已缓解或阻止某些攻击，又可以确定在要执行安全评估时要攻击的位置。

如何执行威胁模型超出了本课程的范围。如果您想学习如何执行威胁建模，请查看 STRIDE 或 DREAD 入门，它们为您提供了可以考虑的威胁类别。

需要注意的一点是，“威胁建模”不是创建图表，而是创建与系统相关的威胁列表。这是我见过一些顾问被赶上的事情。在编写威胁列表之前，最好先从图表开始，甚至可能标记图表本身。

例如，下面是使用 STRIDE 格式的 OGPatientBooking 应用程序的示例威胁列表：

**欺骗**

- 威胁：攻击者可以通过破坏管理用户帐户来冒充医院工作人员访问敏感数据。
- 示例：为获取管理员凭据而进行的网络钓鱼攻击。

**篡改**

- 威胁：未经授权更改会话缓存或共享 MySQL 数据库中的数据可能会导致使用不正确的患者信息。
- 示例：修改患者记录或预约时间的 SQL 注入。

**否认**

- 威胁：如果没有适当的日志记录和审核，患者或工作人员可能会拒绝他们在系统内采取的行动。
- 示例：患者拒绝更新其联系信息，导致错过预约通知。

**信息披露：**

- 威胁：由于不安全的端点访问控制，患者数据意外泄露。
- 示例：OGPatientBooking 系统中的 IDOR 漏洞允许未经授权的用户访问患者数据。通过操纵 URL 参数或可预测的资源标识符，攻击者可以访问属于其他患者的私人信息。

**拒绝服务：**

- 威胁：系统可能被恶意流量淹没，阻止患者预约或签到。
- 示例：针对托管应用程序的 EC2 实例的 DDoS 攻击。

**特权提升：**

- 威胁：攻击者可以利用漏洞获得比预期更高的权限，访问仅限于管理员用户的功能或访问其他医院的数据。
- 示例：利用 React 前端的漏洞获取管理员级访问权限。

虽然这部分不是所有报告的必修课，但我总是建议在评估开始时将威胁建模作为一项任务（尤其是针对复杂系统的评估）。它不一定是正式的，你也不需要花太多时间去做，但它会帮助你专注于在评估期间应该审查的关键领域。

## 使用的工具

我在报告中看到的东西，虽然可能不是最近看到的，是参与中使用的工具的表格或列表。本节背后的原因可能有两个：

- 向客户展示使用什么工具来发现报告中发现的各种问题，也许这样他们就可以检查自己
- 向对评估中使用的工具执行修正验证的任何人提供信息

此列表应涵盖使用的所有工具，无论它们是否发现了特定问题。这可以呈现出来，但感觉很自然，但我个人认为桌子看起来最好：

| **工具名称**    | **网站**                                   | **描述**                                                     |
| --------------- | ------------------------------------------ | ------------------------------------------------------------ |
| Nmap            | https://nmap.org                           | 一种网络发现和安全审核工具，用于发现计算机网络上的主机和服务。 |
| Wireshark       | https://www.wireshark.org                  | 一种网络协议分析器，可用于捕获和交互式浏览网络上运行的流量。 |
| Metasploit      | https://www.metasploit.com                 | 用于针对远程目标计算机开发和执行漏洞利用代码的框架。         |
| Burp Suite      | https://portswigger.net/burp               | 用于执行 Web 应用程序安全测试的集成平台。                    |
| Nessus          | https://www.tenable.com                    | 一种漏洞扫描程序，旨在识别和评估各种系统的漏洞。             |
| OWASP ZAP       | https://www.zaproxy.org                    | 开源 Web 应用程序安全扫描程序。                              |
| John the Ripper | https://www.openwall.com/john              | 一种密码破解工具，可自动检测密码哈希类型并包含可自定义的破解程序。 |
| Aircrack-ng     | https://www.aircrack-ng.org                | 一套用于 802.11a/b/g WEP 和 WPA 破解的工具。                 |
| SQLmap          | http://sqlmap.org                          | 一种开源渗透测试工具，可自动检测和利用 SQL 注入缺陷的过程。  |
| Hydra           | https://github.com/vanhauser-thc/thc-hydra | 一个非常快速的网络登录破解程序，支持许多不同的服务。         |

此表最好存储在报告的附录部分。

另一种方法是在调查结果本身中讨论任何特定的工具用法，而不是维护这样的列表进行评估。这样一来，客户就不需要主动询问您使用了什么工具，也不需要维护一个可能很长的工具列表，这些工具对某些客户来说可能是显而易见的，从而从您的待办事项列表中删除另一个任务。

## 关键攻击链/路径

过去广受好评的一个部分（我经常在执行摘要中引用）是包含重要攻击链列表的部分。这应该演示没有访问权限（或有限访问权限）的攻击者如何破坏评估解决方案的资产。

资产可以是很多东西，但它是组织应该保护的有价值的东西。资产是威胁建模练习的一部分，虽然不在本课程的范围内，但我鼓励你调查威胁建模的工作原理并了解关键术语。理想情况下，攻击链的末端会影响资产或导致攻击者在网络定位或权限方面的访问发生变化。

攻击链可以用多种方式表示，例如简单的列表甚至流程图。您选择如何显示此信息取决于您，但为了您的客户考虑可读性。为了避免我制作图表，我将列出一些示例。

**访问患者预约数据**

1. 通过未经身份验证的 API 端点发现医院门户页面
2. 暴力患者出生日期进入登记屏幕
3. 患者详细信息更新页面中的 SQL 注入
4. 由于共享数据库，编辑、提取或删除所有医院的患者数据库数据

**访问患者预约数据**

1. 通过未经身份验证的 API 端点发现医院门户页面
2. 暴力患者出生日期进入登记屏幕
3. 利用不安全的直接对象引用漏洞访问其他患者的数据 - 利用未经身份验证的 API 端点漏洞获取医院 ID，以访问其他医院的患者数据

**访问管理员门户导致拒绝服务风险**

1. 通过未经身份验证的 API 端点发现医院门户页面
2. 发现 /admin/ 页面的 URL 暴力破解
3. 登录页面上的用户名枚举攻击 - 存在通用“管理员”帐户
4. 针对“管理员”帐户的密码猜测攻击 - 使用的默认密码
5. 访问登录面板（没有可用或正在使用的多因素身份验证）
6. 能够更改所有医院设置 - 拒绝服务风险

**访问患者预订数据**（可能）

1. 通过互联网对暴露的 SSH 服务器进行密码猜测攻击
2. 从代码或环境中提取数据库连接详细信息
3. 连接到数据库并提取或修改数据

**访问患者数据**（潜在）

1. 通过互联网对暴露的 SSH 服务器进行密码猜测攻击
2. 从代码或环境中提取数据库连接详细信息
3. 连接到数据库并提取医院 EMR 凭证
4. 连接到医院 EMR 系统以访问和编辑患者数据

拥有潜在和已实现的攻击链列表有助于传达漏洞链接在一起时可能有多严重的集体风险和影响。除了高级执行摘要说明之外，这也很有用，可以逐步说明攻击者如何利用该解决方案。

可能需要执行这些攻击链中的一个或多个，并且这方面的证据将在附录部分捕获（或者以其他方式具有相当大的单个发现）。这将向客户表明这些攻击链不仅仅是理论上的。

## 课程总结

考虑您是否认为您的报告可以从上述任何部分中受益，以帮助您的客户了解您的评估结果。此外，请考虑是否可能缺少其他部分。

虽然在报告中添加其他部分可能会增加报告开销，但应鼓励在增加价值且对客户有用的地方使用它们。

# 21-其他报告部分 - 练习

在上一课中，关于报告中可能包含的不同类型的附加部分涵盖了相当多的内容。

以下是一些相关的经验教训，可以帮助您扩展知识并在以后的报告中使用这些部分。

**反思练习**

对于您最近看到或撰写的报告：

- 考虑是否可以添加前面讨论的任何部分以提高报告质量，或者它们是否对客户有所帮助。
  - 返回并创建这些可能缺失的部分以供练习。

**一般练习**

创建您经常使用的工具列表，其中包括其名称、网站（或可能的 GitHub 存储库）和简要说明，以便在报告中引用。

**超越练习**

上一课中讨论的一些部分要么超出了渗透测试报告的“通常”标准报告，要么涵盖了本报告编写课程范围之外的领域。但是，如果您想自己深入研究这些领域，这里有一些可选的作业：

- 选择三个利用多个组件运行的开源项目（这些组件可以是 Web 服务器、数据库或其他组件），然后：
  - 为他们创建体系结构概述部分
  - 创建解决方案的数据流图
  - 创建解决方案的修改数据流图，将其转换为威胁模型图。软件选项可能包括：
    - Draw.io 以下库 https://github.com/michenriksen/drawio-threatmodeling
    - Microsoft 威胁建模工具
    - OWASP Threat Dragon
- 针对一个或多个常见框架（例如 STRIDE 和 DREAD）创建解决方案的威胁模型

一些例子可能是：

- NextCloud
  - 网址： https://nextcloud.com/
  - 描述： Nextcloud 是一个开源的自托管文件共享和协作平台。它利用 Web 服务器、数据库和存储系统等组件。
- Mattermost
  - 网址： https://mattermost.com/
  - 描述： Mattermost 是一个面向团队和组织的开源消息传递平台。它依赖于 Web 服务器、数据库和实时消息传递系统等组件。
- GitLab
  - 网址： https://about.gitlab.com/
  - 描述： GitLab 是一个开源 DevOps 平台，提供源代码管理、CI/CD 等。它使用 Web 服务器、数据库和版本控制系统等组件。

# 22-本章小结

在本章中，我们介绍了渗透测试报告中最有可能出现的所有主要部分。让我们来看看本章的一些关键要点。

- 大多数报告中显示的核心部分是
  - 摘要
  - 建议
  - 范围
  - 警告
  - 发现
  - 附录
- 报告还包含多个杂项部分和数据点
  - 扉页，通常是报告的开头，包含评估的名称、作者和报告的编写组织
  - 目录
  - 变更控制部分，详细说明文档中随时间推移的更改以及谁进行了更改
  - 有关评估团队的信息，包括姓名、职称和证书
  - 有关评估的一般元数据，包括对提案的引用、文件的分类、评估日期等。
- 执行摘要应涵盖评估的要点，以便高管理解。它应包括：
  - 在参与范围中考虑了哪些风险和威胁
  - 发现了哪些风险
  - 发现的影响是什么
  - 关于记录和监控的评论，以防发现可能导致违规行为的严重发现
  - 客户可能会立即采取一些后续步骤
- 建议部分应侧重于高级修正计划，以便：
  - 修正重要发现
  - 建议如何发现未来可能出现的问题，或完全阻止它们出现
  - 建议可以执行的进一步工作以发现风险
- 报告中有一个或多个调查结果概述部分
  - 一个是按严重程度对发现的数量进行细分
  - 另一种方法是在表格中列出调查结果，通常带有风险评级
  - 图形和图表可以使这些信息更具可读性
- 范围部分应用于捕捉评估的目标是什么以及正在评估的内容的细节
  - 范围界定信息可以存储在表格中，也可以像报告的任何其他部分一样完全编写
  - 镜像原始范围界定文档的信息非常重要
- 警告部分应用于突出评估无法完成概述工作的问题或原因。
  - 它不应该被用来责怪客户，即使这是他们的错。
  - 坚持事实并尽可能详细，以帮助客户了解已涵盖和未涵盖的内容（如果他们返回完成评估，这也可能会对您的团队有所帮助）
- 结果部分存储评估中发现的问题的技术信息。
  - 深思熟虑如何构建这一部分，在有意义的地方将工作的不同阶段分开
  - 与您的客户交谈，看看不同的团队是否可能负责工作的不同阶段 - 这可能是您可能通过分离工作来帮助客户的迹象
- 附录部分应用于存储可能使主要报告文件杂乱无章的信息，或存储大量参考资料
  - 考虑使用补充文档（例如电子表格）而不是使用附录，如果附录会显着增加页数或以不同的格式对客户更有用
- 如果您正在执行的评估具有与您的正常工作不同的特定要求，则在报告的正文或附录中添加其他部分以存储这些要求的结果可能会有所帮助

确保您的报告文件涵盖基本内容至关重要。如果没有上述几个部分，您很可能不会在评估结束时向客户传达正确的信息。
